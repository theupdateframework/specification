<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>The Update Framework Specification</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in § N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *     -> ins/del.c### for candidate and proposed changes (amendments)
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *   - .correction for "candidate corrections"       (div, aside, details, section)
 *   - .addition   for "candidate additions"         (div, aside, details, section)
 *   - .correction.proposed for "proposed corrections" (div, aside, details, section)
 *   - .addition.proposed   for "proposed additions"   (div, aside, details, section)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Outdated warning for old specs
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/* color variables included separately for reliability */

/******************************************************************************/
/*                                    Body                                    */
/******************************************************************************/

	html {
	}

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;			  /* limit line length to 50em for readability   */
		margin: 0 auto;				/* center text within page                    */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag    */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		color: black;
		color: var(--text);
		background: white top left fixed no-repeat;
		background: var(--bg) top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em; }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border: solid var(--logo-bg);
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		background: var(--logo-bg);
		color: white;
		color: var(--logo-text);
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		background: var(--logo-active-bg);
		border-color: #c00;
		border-color: var(--logo-active-bg);
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small; }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 3;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;

			color: #707070;
			color: var(--tocnav-normal-text);
			background: white;
			background: var(--tocnav-normal-bg);
		}
		#toc-nav > a:hover,
		#toc-nav > a:focus {
			color: black;
			color: var(--tocnav-hover-text);
			background: #f8f8f8;
			background: var(--tocnav-hover-bg);
		}
		#toc-nav > a:active {
			color: #c00;
			color: var(--tocnav-active-text);
			background: white;
			background: var(--tocnav-active-bg);
		}

		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			color: black;
			color: var(--tocsidebar-text);
			background: inherit;
			background-color: #f7f8f9;
			background-color: var(--tocsidebar-bg);
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
			box-shadow: -.1em 0 .25em var(--tocsidebar-shadow) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
			color: var(--tocsidebar-heading-text);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;	/* Inherit the font family. */
		line-height: 1.2;		/* Keep wrapped headings compact */
		hyphens: manual;		/* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		color: var(--heading-text);
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#profile-and-date {
		/* #profile-and-date is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > :not(.head) + hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		color: black;
		color: var(--hr-text);
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	border-left: 0.5em solid #DEF;
	border-left: 0.5em solid var(--algo-border);
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	 padding: .5em;
	 border: thin solid #ddd;
	 border: thin solid var(--algo-border);
	 border-radius: .5em;
	 margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	 margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	 margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	margin-left: -2em;
	}
	dl.switch {
	padding-left: 2em;
	}
	dl.switch > dt {
	text-indent: -1.5em;
	margin-top: 1em;
	}
	dl.switch > dt + dt {
	margin-top: 0;
	}
	dl.switch > dt::before {
	content: '\21AA';
	padding: 0 0.5em 0 0;
	display: inline-block;
	width: 1em;
	text-align: right;
	line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del {
		color: #aa0000;
		color: var(--del-text);
		background: transparent;
		background: var(--del-bg);
		text-decoration: line-through;
	}
	ins {
		color: #006100;
		color: var(--ins-text);
		background: transparent;
		background: var(--ins-bg);
		text-decoration: underline;
	}

	/* for amendments (candidate/proposed changes) */

	.amendment ins, .correction ins, .addition ins,
	ins[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment del, .correction del, .addition del,
	del[class^=c] {
		text-decoration-style: dotted;
	}
	.amendment.proposed ins, .correction.proposed ins, .addition.proposed ins,
	ins[class^=c].proposed {
		text-decoration-style: double;
	}
	.amendment.proposed del, .correction.proposed del, .addition.proposed del,
	del[class^=c].proposed {
		text-decoration-style: double;
	}

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		hyphens: none;
		text-transform: none;
		text-align: left;
		text-align: start;
		font-variant: normal;
		orphans: 3;
		widows: 3;
		page-break-before: avoid;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

	/* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		color: var(--a-normal-text);
		text-decoration: underline #707070;
		text-decoration: underline var(--a-normal-underline);
		text-decoration-skip-ink: none;
	}
	a:visited {
		color: #034575;
		color: var(--a-visited-text);
		text-decoration-color: #bbb;
		text-decoration-color: var(--a-visited-underline);
	}

	/* Indicate interaction with the link */
	a[href]:focus,
	a[href]:hover {
		text-decoration-thickness: 2px;
	}
	a[href]:active {
		color: #c00;
		color: var(--a-active-text);
		text-decoration-color: #c00;
		text-decoration-color: var(--a-active-underline);
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	img, svg {
		/* Intentionally not color-scheme aware. */
		background: white;
	}

	/* For autogen numbers, add
	  .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,	.sidefigure img,	figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
		height: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em;
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em; }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote,
	.amendment, .correction, .addition {
		margin: 1em auto;
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	blockquote > :first-child,
	.note  > p:first-child,
	.issue > p:first-child,
	.amendment > p:first-child,
	.correction > p:first-child,
	.addition > p:first-child {
		margin-top: 0;
	}
	blockquote > :last-child,
	.note  > p:last-child,
	.issue > p:last-child,
	.amendment > p:last-child,
	.correction > p:last-child,
	.addition > p:last-child {
		margin-bottom: 0;
	}


	.issue::before, .issue > .marker,
	.example::before, .example > .marker,
	.note::before, .note > .marker,
	details.note > summary > .marker,
	.amendment::before, .amendment > .marker,
	details.amendment > summary > .marker,
	.addition::before, .addition > .marker,
	addition.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	correction.amendment > summary > .marker
	{
		text-transform: uppercase;
		padding-right: 1em;
	}

	.example::before, .example > .marker {
		display: block;
		padding-right: 0em;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
		border-color: var(--blockquote-border);
		background: transparent;
		background: var(--blockquote-bg);
		color: currentcolor;
		color: var(--blockquote-text);
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #e05252;
		border-color: var(--issue-border);
		background: #fbe9e9;
		background: var(--issue-bg);
		color: black;
		color: var(--issue-text);
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		color: #831616;
		color: var(--issueheading-text);
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	  or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #e0cb52;
		border-color: var(--example-border);
		background: #fcfaee;
		background: var(--example-bg);
		color: black;
		color: var(--example-text);
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #574b0f;
		color: var(--exampleheading-text);
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	  or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52e052;
		border-color: var(--note-border);
		background: #e9fbe9;
		background: var(--note-bg);
		color: black;
		color: var(--note-text);
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary {
		color: hsl(120, 70%, 30%);
		color: var(--noteheading-text);
	}
	/* Add .note::before { content: "Note "; } for autogen label,
	  or use class="marker" to mark up the label in source. */

	details.note[open] > summary {
		border-bottom: 1px silver solid;
		border-bottom: 1px var(--notesummary-underline) solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		border-color: var(--assertion-border);
		background: #EEE;
		background: var(--assertion-bg);
		color: black;
		color: var(--assertion-text);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-color: var(--advisement-border);
		border-style: none solid;
		background: #fec;
		background: var(--advisement-bg);
		color: black;
		color: var(--advisement-text);
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement::before, .advisement > .marker {
		color: #b35f00;
		color: var(--advisementheading-text);
	}

/** Amendment Box *************************************************************/

	.amendment, .correction, .addition {
		border-color: #330099;
		border-color: var(--amendment-border);
		background: #F5F0FF;
		background: var(--amendment-bg);
		color: black;
		color: var(--amendment-text);
	}
	.amendment.proposed, .correction.proposed, .addition.proposed {
		border-style: solid;
		border-block-width: 0.25em;
	}
	.amendment::before, .amendment > .marker,
	details.amendment > summary::before, details.amendment > summary > .marker,
	.correction::before, .correction > .marker,
	details.correction > summary::before, details.correction > summary > .marker,
	.addition::before, .addition > .marker,
	details.addition > summary::before, details.addition > summary > .marker {
		color: #220066;
		color: var(--amendmentheading-text);
	}
	.amendment.proposed::before, .amendment.proposed > .marker,
	details.amendment.proposed > summary::before, details.amendment.proposed > summary > .marker,
	.correction.proposed::before, .correction.proposed > .marker,
	details.correction.proposed > summary::before, details.correction.proposed > summary > .marker,
	.addition.proposed::before, .addition.proposed > .marker,
	details.addition.proposed > summary::before, details.addition.proposed > summary > .marker {
		font-weight: bold;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: hsla(40,100%,50%,0.95);
		background: var(--warning-bg);
		color: black;
		color: var(--warning-text);
		padding: .75em 1em;
		border: red;
		border: var(--warning-border);
		border-style: solid none;
		box-shadow: 0 2px 8px black;
		text-align: center;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 0;
		right: 0;
		bottom: 2em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #def;
		background: var(--def-bg);
		margin: 1.2em 0;
		border-left: 0.5em solid #8ccbf2;
		border-left: 0.5em solid var(--def-border);
		color: black;
		color: var(--def-text);
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
		border-bottom: 1px solid var(--defrow-border);
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def td.footnote {
		padding-top: 0.6em;
	}
	table.def td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		<table class="data"> highlights structural relationships in a table
		when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		Use class="complex data" for particularly complicated tables --
		(This will draw more lines: busier, but clearer.)

		Use class="long" on table cells with paragraph-like contents
		(This will adjust text alignment accordingly.)
		Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-color: var(--datacell-border);
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		border-top: 1px solid var(--datacell-border);
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		border: 1px solid var(--datacell-border);
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
		vertical-align: baseline;
		text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding: 0.1rem 1px 0;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Switch to using border-bottom for underlines */
		text-decoration: none;
		border-bottom: 1px solid;
		/* Reverse color scheme */
		color: black;
		color: var(--toclink-text);
		border-color: #3980b5;
		border-color: var(--toclink-underline);
	}
	.toc a:visited {
		color: black;
		color: var(--toclink-visited-text);
		border-color: #054572;
		border-color: var(--toclink-visited-underline);
	}
	.toc a:focus,
	.toc a:hover {
		background: rgba(75%, 75%, 75%, .25);
		background: var(--a-hover-bg);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
	}
	.toc {
		line-height: 1.1em;
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li			{ font-weight: bold;   }
	.toc > li li		 { font-weight: normal; }
	.toc > li li li	  { font-size:   95%;	}
	.toc > li li li li	{ font-size:   90%;	}
	.toc > li li li li li { font-size:   85%;	}

	/* @supports not (display:grid) { */
		.toc > li			{ margin: 1.5rem 0;	}
		.toc > li li		 { margin: 0.3rem 0;	}
		.toc > li li li	  { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}
		.toc > li li li li .secno { font-size: 85%; }
		.toc > li li li li li .secno { font-size: 100%; }

		.toc li {
			clear: both;
		}

		:not(li) > .toc			 { margin-left:  5rem; }
		.toc .secno				 { margin-left: -5rem; }
		.toc > li li li .secno	  { margin-left: -7rem; }
		.toc > li li li li .secno	{ margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc			 { margin-left:  4rem; }
			.toc .secno				 { margin-left: -4rem; }
			.toc > li li li			 { margin-left:  1rem; }
			.toc > li li li .secno	  { margin-left: -5rem; }
			.toc > li li li li .secno	{ margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
		/* Loosen it on wide screens */
		@media screen and (min-width: 78em) {
			body:not(.toc-inline) :not(li) > .toc			 { margin-left:  4rem; }
			body:not(.toc-inline) .toc .secno				 { margin-left: -4rem; }
			body:not(.toc-inline) .toc > li li li			 { margin-left:  1rem; }
			body:not(.toc-inline) .toc > li li li .secno	  { margin-left: -5rem; }
			body:not(.toc-inline) .toc > li li li li .secno	{ margin-left: -6rem; }
			body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			  comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
		}
		#toc .content:hover,
		#toc .content:focus {
			background: rgba(75%, 75%, 75%, .25);
			background: var(--a-hover-bg);
			border-bottom: 3px solid #054572;
			border-bottom: 3px solid var(--toclink-underline);
			margin-bottom: -3px;
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index	  { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li	{ margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em; }
	ul.index dl	{ margin-top: 0; }
	ul.index dt	{ margin: .2em 0 .2em 20px;}
	ul.index dd	{ margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li a + span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
			color: var(--indexinfo-text);
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		color: black;
		color: var(--indextable-hover-text);
		background: #f7f8f9;
		background: var(--indextable-hover-bg);
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/** Outdated warning **********************************************************/

.outdated-spec {
	color: black;
	color: var(--outdatedspec-text);
	background-color: rgba(0,0,0,0.5);
	background-color: var(--outdatedspec-bg);
}

.outdated-warning {
	position: fixed;
	bottom: 50%;
	left: 0;
	right: 0;
	margin: 0 auto;
	width: 50%;
	background: maroon;
	background: var(--outdated-bg);
	color: white;
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	color: var(--outdated-text);
	border-radius: 1em;
	box-shadow: 0 0 1em red;
	box-shadow: 0 0 1em var(--outdated-shadow);
	padding: 2em;
	text-align: center;
	z-index: 2;
}

.outdated-warning a {
	color: currentcolor;
	background: transparent;
}

.edited-rec-warning {
	background: darkorange;
	background: var(--editedrec-bg);
	box-shadow: 0 0 1em;
}

.outdated-warning button {
	position: absolute;
	top: 0;
	right:0;
	margin: 0;
	border: 0;
	padding: 0.25em 0.5em;
	background: transparent;
	color: white;
	color: var(--outdated-text);
	font:1em sans-serif;
	text-align:center;
}

.outdated-warning span {
	display: block;
}

.outdated-collapsed {
	bottom: 0;
	border-radius: 0;
	width: 100%;
	padding: 0;
}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}

		.outdated-warning {
			position: absolute;
			border-style: solid;
			border-color: red;
		}

		.outdated-warning input {
			display: none;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge {
		/* Magic to create good item positioning:
		  "content column" is 50ems wide at max; less on smaller screens.
		  Extra space (after ToC + content) is empty on the right.

		  1. When item < content column, centers item in column.
		  2. When content < item < available, left-aligns.
		  3. When item > available, fills available + scroll bar.
		*/
		display: grid;
		grid-template-columns: minmax(0, 50em);
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			* http://lea.verou.me/2012/04/background-attachment-local/
			*
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
						top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
						top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
						white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version 3383f409d, updated Fri Apr 28 15:49:22 2023 -0700" name="generator">
  <meta content="fed21b0747529b569db1100592b716d48b639f23" name="document-revision">
<style>/* style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}
</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}
</style>
<style>/* style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">The Update Framework Specification</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content"> Version: 1.0.32 <br> Last modified: <time class="dt-updated" datetime="2023-03-02">2 March 2023</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Feedback:
     <dd><span><a href="mailto:https://groups.google.com/forum/?fromgroups#!forum/theupdateframework?subject=%5BTUF%5D%20YOUR%20TOPIC%20HERE">https://groups.google.com/forum/?fromgroups#!forum/theupdateframework</a> with subject line “<kbd>[TUF] <i data-lt>… message topic …</i></kbd>”</span>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/theupdateframework/specification/issues/">GitHub</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Justin Cappos</span> (<span class="p-org org">NYU</span>)
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Trishank Karthik Kuppusamy</span> (<span class="p-org org">Datadog</span>)
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Joshua Lock</span> (<span class="p-org org">Verizon</span>)
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Marina Moore</span> (<span class="p-org org">NYU</span>)
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Lukas Pühringer</span> (<span class="p-org org">NYU</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <hr title="Separator for header">
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#scope"><span class="secno">1.1</span> <span class="content">Scope</span></a>
      <li><a href="#motivation"><span class="secno">1.2</span> <span class="content">Motivation</span></a>
      <li><a href="#history-and-credit"><span class="secno">1.3</span> <span class="content">History and credit</span></a>
      <li><a href="#non-goals"><span class="secno">1.4</span> <span class="content">Non-goals</span></a>
      <li>
       <a href="#goals"><span class="secno">1.5</span> <span class="content">Goals</span></a>
       <ol class="toc">
        <li><a href="#goals-for-implementation"><span class="secno">1.5.1</span> <span class="content">Goals for implementation</span></a>
        <li><a href="#goals-to-protect-against-specific-attacks"><span class="secno">1.5.2</span> <span class="content">Goals to protect against specific attacks</span></a>
        <li><a href="#goals-for-pki"><span class="secno">1.5.3</span> <span class="content">Goals for PKI (Public key infrastructure)</span></a>
        <li><a href="#tuf-augmentation-proposal-tap-support"><span class="secno">1.5.4</span> <span class="content">TUF Augmentation Proposal (TAP) support</span></a>
       </ol>
     </ol>
    <li>
     <a href="#system-overview"><span class="secno">2</span> <span class="content">System overview</span></a>
     <ol class="toc">
      <li>
       <a href="#roles-and-pki"><span class="secno">2.1</span> <span class="content">Roles and PKI</span></a>
       <ol class="toc">
        <li><a href="#root"><span class="secno">2.1.1</span> <span class="content">Root role</span></a>
        <li><a href="#targets"><span class="secno">2.1.2</span> <span class="content">Targets role</span></a>
        <li><a href="#snapshot"><span class="secno">2.1.3</span> <span class="content">Snapshot role</span></a>
        <li><a href="#timestamp"><span class="secno">2.1.4</span> <span class="content">Timestamp role</span></a>
        <li><a href="#mirrors"><span class="secno">2.1.5</span> <span class="content">Mirrors role</span></a>
       </ol>
      <li><a href="#threat-model-and-analysis"><span class="secno">2.2</span> <span class="content">Threat model and analysis</span></a>
      <li><a href="#pouf-documents"><span class="secno">2.3</span> <span class="content">Protocol, Operations, Usage, and Format (POUF) documents</span></a>
     </ol>
    <li>
     <a href="#the-repository"><span class="secno">3</span> <span class="content">The repository</span></a>
     <ol class="toc">
      <li>
       <a href="#repository-layout"><span class="secno">3.1</span> <span class="content">Repository layout</span></a>
       <ol class="toc">
        <li><a href="#target-files"><span class="secno">3.1.1</span> <span class="content">Target files</span></a>
        <li>
         <a href="#metadata-files"><span class="secno">3.1.2</span> <span class="content">Metadata files</span></a>
         <ol class="toc">
          <li><a href="#metadata-files-for-targets-delegation"><span class="secno">3.1.2.1</span> <span class="content">Metadata files for targets delegation</span></a>
         </ol>
       </ol>
     </ol>
    <li>
     <a href="#document-formats"><span class="secno">4</span> <span class="content">Document formats</span></a>
     <ol class="toc">
      <li><a href="#metaformat"><span class="secno">4.1</span> <span class="content">Metaformat</span></a>
      <li>
       <a href="#file-formats-general-principles"><span class="secno">4.2</span> <span class="content">File formats: general principles</span></a>
       <ol class="toc">
        <li><a href="#file-formats-object-format"><span class="secno">4.2.1</span> <span class="content">Object format</span></a>
        <li><a href="#file-formats-keys"><span class="secno">4.2.2</span> <span class="content">Key objects</span></a>
        <li><a href="#file-formats-date-time"><span class="secno">4.2.3</span> <span class="content">Date-time</span></a>
       </ol>
      <li><a href="#file-formats-root"><span class="secno">4.3</span> <span class="content">File formats: root.json</span></a>
      <li><a href="#file-formats-snapshot"><span class="secno">4.4</span> <span class="content">File formats: snapshot.json</span></a>
      <li><a href="#file-formats-targets"><span class="secno">4.5</span> <span class="content">File formats: targets.json and delegated target roles</span></a>
      <li><a href="#file-formats-timestamp"><span class="secno">4.6</span> <span class="content">File formats: timestamp.json</span></a>
      <li><a href="#file-formats-mirrors"><span class="secno">4.7</span> <span class="content">File formats: mirrors.json</span></a>
     </ol>
    <li>
     <a href="#detailed-client-workflow"><span class="secno">5</span> <span class="content">Detailed client workflow</span></a>
     <ol class="toc">
      <li><a href="#fix-time"><span class="secno">5.1</span> <span class="content">Record fixed update start time</span></a>
      <li><a href="#load-trusted-root"><span class="secno">5.2</span> <span class="content">Load trusted root metadata</span></a>
      <li><a href="#update-root"><span class="secno">5.3</span> <span class="content">Update the root role</span></a>
      <li><a href="#update-timestamp"><span class="secno">5.4</span> <span class="content">Update the timestamp role</span></a>
      <li><a href="#update-snapshot"><span class="secno">5.5</span> <span class="content">Update the snapshot role</span></a>
      <li><a href="#update-targets"><span class="secno">5.6</span> <span class="content">Update the targets role</span></a>
      <li><a href="#fetch-target"><span class="secno">5.7</span> <span class="content">Fetch target</span></a>
     </ol>
    <li>
     <a href="#repository-operations"><span class="secno">6</span> <span class="content">Repository operations</span></a>
     <ol class="toc">
      <li><a href="#key-management-and-migration"><span class="secno">6.1</span> <span class="content">Key management and migration</span></a>
      <li>
       <a href="#consistent-snapshots"><span class="secno">6.2</span> <span class="content">Consistent snapshots</span></a>
       <ol class="toc">
        <li><a href="#writing-consistent-snapshots"><span class="secno">6.2.1</span> <span class="content">Writing consistent snapshots</span></a>
        <li><a href="#reading-consistent-snapshots"><span class="secno">6.2.2</span> <span class="content">Reading consistent snapshots</span></a>
       </ol>
      <li>
       <a href="#adding-updating-targets"><span class="secno">6.3</span> <span class="content">Adding and updating targets</span></a>
       <ol class="toc">
        <li><a href="#update-targets-metadata"><span class="secno">6.3.1</span> <span class="content">Update targets metadata</span></a>
        <li><a href="#update-snapshot-metadata"><span class="secno">6.3.2</span> <span class="content">Update snapshot metadata</span></a>
        <li><a href="#update-timestamp-metadata"><span class="secno">6.3.3</span> <span class="content">Update timestamp metadata</span></a>
       </ol>
     </ol>
    <li>
     <a href="#future-directions-and-open-questions"><span class="secno">7</span> <span class="content">Future directions and open questions</span></a>
     <ol class="toc">
      <li><a href="#support-for-bogus-clocks"><span class="secno">7.1</span> <span class="content">Support for bogus clocks</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <p class="note" role="note"><span class="marker">Note:</span> We strive to make the specification easy to implement, so if you come
across any inconsistencies or experience any difficulty, do let us know by
sending an email to our <a href="https://groups.google.com/forum/?fromgroups#!forum/theupdateframework">mailing list</a>,
or by reporting an issue in the <a href="https://github.com/theupdateframework/specification/issues">specification repo</a>.</p>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <h3 class="heading settled" data-level="1.1" id="scope"><span class="secno">1.1. </span><span class="content">Scope</span><a class="self-link" href="#scope"></a></h3>
   <p>This document describes a framework for securing software update systems.</p>
   <p>The keywords "MUST," "MUST NOT," "REQUIRED," "SHALL," "SHALL NOT," "SHOULD,"
"SHOULD NOT," "RECOMMENDED," "MAY," and "OPTIONAL" in this document are to be
interpreted as described in <a href="https://tools.ietf.org/html/rfc2119">RFC 2119</a>.</p>
   <h3 class="heading settled" data-level="1.2" id="motivation"><span class="secno">1.2. </span><span class="content">Motivation</span><a class="self-link" href="#motivation"></a></h3>
   <p>Software is commonly updated through software update systems.  These systems
can be package managers that are responsible for all of the software that is
installed on a system, application updaters that are only responsible for
individual installed applications, or software library managers that install
software that adds functionality such as plugins or programming language
libraries.</p>
   <p>Software update systems all have the common behavior of downloading files
that identify whether updates exist and, when updates do exist, downloading
the files that are required for the update.  For the implementations
concerned with security, various integrity and authenticity checks are
performed on downloaded files.</p>
   <p>Software update systems are vulnerable to a variety of known attacks.  This
is generally true even for implementations that have tried to be secure.</p>
   <h3 class="heading settled" data-level="1.3" id="history-and-credit"><span class="secno">1.3. </span><span class="content">History and credit</span><a class="self-link" href="#history-and-credit"></a></h3>
   <p>Work on TUF began in late 2009.  The core ideas are based off of previous
work done by Justin Cappos and Justin Samuel that <a href="https://theupdateframework.io/papers/attacks-on-package-managers-ccs2008.pdf">identified security flaws
in all popular Linux package managers</a>.
More information and current versions of this document can be found at <a href="https://theupdateframework.io/">https://theupdateframework.io/</a></p>
   <p>The <a href="https://www.geni.net/">Global Environment for Network Innovations</a> (GENI)
and the <a href="https://www.nsf.gov/">National Science Foundation</a> (NSF) have
provided support for the development of TUF.</p>
   <p>TUF’s reference implementation is based on prior work on <a href="https://www.torproject.org/">Thandy</a>, the application
updater for Tor. Its design and this spec
also came from ideas jointly developed in discussion with Thandy’s authors.
The Thandy spec can be found at <a href="https://gitweb.torproject.org/thandy.git/tree/specs/thandy-spec.txt">https://gitweb.torproject.org/thandy.git/tree/specs/thandy-spec.txt </a></p>
   <p>Whereas Thandy is an application updater for an individual software project,
TUF aims to provide a way to secure any software update system. We’re very
grateful to the Tor Project and the Thandy developers for the early discussion
that led to the ideas in Thandy and TUF. Thandy is the hard
work of Nick Mathewson, Sebastian Hahn, Roger Dingledine, Martin Peck, and
others.</p>
   <h3 class="heading settled" data-level="1.4" id="non-goals"><span class="secno">1.4. </span><span class="content">Non-goals</span><a class="self-link" href="#non-goals"></a></h3>
   <p>We are not creating a universal update system, but rather a simple and
flexible way that applications can have high levels of security with their
software update systems.  Creating a universal software update system would
not be a reasonable goal due to the diversity of application-specific
functionality in software update systems and the limited usefulness that
such a system would have for securing legacy software update systems.</p>
   <p>We won’t be defining package formats or even performing the actual update
of application files.  We will provide the simplest mechanism possible that
remains easy to use and provides a secure way for applications to obtain and
verify files being distributed by trusted parties.</p>
   <p>We are not providing a means to bootstrap security so that arbitrary
installation of new software is secure.  In practice this means that people
still need to use other means to verify the integrity and authenticity of
files they download manually.</p>
   <p>The framework will not have the responsibility of deciding on the correct
course of action in all error situations, such as those that can occur when
certain attacks are being performed.  Instead, the framework will provide
the software update system the relevant information about any errors that
require security decisions which are situation-specific.  How those errors
are handled is up to the software update system.</p>
   <h3 class="heading settled" data-level="1.5" id="goals"><span class="secno">1.5. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
   <p>We need to provide a framework (a set of libraries, file formats, and
utilities) that can be used to secure new and existing software update
systems.</p>
   <p>The framework should enable applications to be secure from all known attacks
on the software update process.  It is not concerned with exposing
information about what software is being updated (and thus what software
the client may be running) or the contents of updates.</p>
   <p>The framework should provide means to minimize the impact of key compromise.
To do so, it must support roles with multiple keys and threshold/quorum
trust (with the exception of minimally trusted roles designed to use a
single key).  The compromise of roles using highly vulnerable keys should
have minimal impact.  Therefore, online keys (keys which are used in an
automated fashion) must not be used for any role that clients ultimately
trust for files they may install.</p>
   <p>The framework must be flexible enough to meet the needs of a wide variety of
software update systems.</p>
   <p>The framework must be easy to integrate with software update systems.</p>
   <h4 class="heading settled" data-level="1.5.1" id="goals-for-implementation"><span class="secno">1.5.1. </span><span class="content">Goals for implementation</span><a class="self-link" href="#goals-for-implementation"></a></h4>
   <ul>
    <li data-md>
     <p>The client side of the framework must be straightforward to implement in any
programming language and for any platform with the requisite networking and
crypto support.</p>
    <li data-md>
     <p>The process by which developers push updates to the repository must be
simple.</p>
    <li data-md>
     <p>The framework must be secure to use in environments that lack support for
SSL (TLS).  This does not exclude the optional use of SSL when available,
but the framework will be designed without it.</p>
   </ul>
   <h4 class="heading settled" data-level="1.5.2" id="goals-to-protect-against-specific-attacks"><span class="secno">1.5.2. </span><span class="content">Goals to protect against specific attacks</span><a class="self-link" href="#goals-to-protect-against-specific-attacks"></a></h4>
   <p class="note" role="note"><span class="marker">Note:</span> When saying the framework protects against an attack, it means the
attack will be unsuccessful.  It does not mean that a client will always
successfully update during an attack.  Fundamentally, an attacker
positioned to intercept and modify a client’s communication can always
perform a denial of service.  Nevertheless, the framework must detect
when a client is unable to update.</p>
   <ul>
    <li data-md>
     <p><strong>Arbitrary installation attacks.</strong> An attacker cannot install anything
they want on the client system. That is, an attacker cannot provide
arbitrary files in response to download requests.</p>
    <li data-md>
     <p><strong>Endless data attacks.</strong> An attacker cannot respond to client
requests with huge amounts of data (extremely large files) that interfere
with the client’s system.</p>
    <li data-md>
     <p><strong>Extraneous dependencies attacks.</strong> An attacker cannot cause clients
to download or install software dependencies that are not the intended
dependencies.</p>
    <li data-md>
     <p><strong>Fast-forward attacks.</strong> An attacker cannot arbitrarily increase the
version numbers of metadata files, listed in the snapshot metadata, well
beyond the current value and thus tricking a software update system into
thinking any subsequent updates are trying to rollback the package to a
previous, out-of-date version.  In some situations, such as those where
there is a maximum possible version number, the perpetrator cannot use a
number so high that the system would never be able to match it with the
one in the snapshot metadata, and thus new updates could never be
downloaded.</p>
    <li data-md>
     <p><strong>Indefinite freeze attacks.</strong> An attacker cannot respond to client
requests with the same, outdated metadata without the client being aware
of the problem.</p>
    <li data-md>
     <p><strong>Malicious mirrors preventing updates.</strong> A repository mirror cannot
prevent updates from good mirrors.</p>
    <li data-md>
     <p><strong>Mix-and-match attacks.</strong> An attacker cannot trick clients into using
a combination of metadata that never existed together on the repository
at the same time.</p>
    <li data-md>
     <p><strong>Rollback attacks.</strong> An attacker cannot trick clients into installing
software that is older than that which the client previously knew to be
available.</p>
    <li data-md>
     <p><strong>Vulnerability to key compromises.</strong> An attacker, who is able to
compromise a single key or less than a given threshold of keys, cannot
compromise clients.  This includes compromising a single online key (such
as only being protected by SSL) or a single offline key (such as most
software update systems use to sign files).</p>
    <li data-md>
     <p><strong>Wrong software installation.</strong> An attacker cannot provide a file
(trusted or untrusted) that is not the one the client wanted.</p>
   </ul>
   <h4 class="heading settled" data-level="1.5.3" id="goals-for-pki"><span class="secno">1.5.3. </span><span class="content">Goals for PKI (Public key infrastructure)</span><a class="self-link" href="#goals-for-pki"></a></h4>
   <ul>
    <li data-md>
     <p>Software update systems using the framework’s client code interface should
never have to directly manage keys.</p>
    <li data-md>
     <p>All keys must be easily and safely revocable.  Trusting new keys for a role
must be easy.</p>
    <li data-md>
     <p>For roles where trust delegation is meaningful, a role should be able to
delegate full or limited trust to another role.</p>
    <li data-md>
     <p>The root of trust must not rely on external PKI.  That is, no authority will
be derived from keys outside of the framework.</p>
   </ul>
   <h4 class="heading settled" data-level="1.5.4" id="tuf-augmentation-proposal-tap-support"><span class="secno">1.5.4. </span><span class="content">TUF Augmentation Proposal (TAP) support</span><a class="self-link" href="#tuf-augmentation-proposal-tap-support"></a></h4>
   <p>This major version (1.x.y) of the specification adheres to the following TAPs:</p>
   <ul>
    <li data-md>
     <p><a href="https://github.com/theupdateframework/taps/blob/master/tap6.md">TAP 6</a>:
  Include specification version in metadata</p>
    <li data-md>
     <p><a href="https://github.com/theupdateframework/taps/blob/master/tap9.md">TAP 9</a>:
  Mandatory Metadata signing schemes</p>
    <li data-md>
     <p><a href="https://github.com/theupdateframework/taps/blob/master/tap10.md">TAP 10</a>:
  Remove native support for compressed metadata</p>
    <li data-md>
     <p><a href="https://github.com/theupdateframework/taps/blob/master/tap11.md">TAP 11</a>:
  Using POUFs for Interoperability</p>
   </ul>
   <p>Implementations compliant with this major version (1.x.y) of the specification
must also comply with the TAPs mentioned above.</p>
   <h2 class="heading settled" data-level="2" id="system-overview"><span class="secno">2. </span><span class="content">System overview</span><a class="self-link" href="#system-overview"></a></h2>
   <p>The framework ultimately provides a secure method of obtaining trusted
files.  To avoid ambiguity, we will refer to the files the framework is used
to distribute as "target files".  Target files are opaque to the framework.
Whether target files are packages containing multiple files, single text
files, or executable binaries is irrelevant to the framework.</p>
   <p>The metadata describing target files is the information necessary to
securely identify the file and indicate which roles are trusted to provide
the file.  As providing additional information about
target files may be important to some software update systems using the
framework, additional arbitrary information can be provided with any target
file. This information will be included in signed metadata that describes
the target files.</p>
   <p>The following are the high-level steps of using the framework from the
viewpoint of a software update system using the framework.  This is an
error-free case.</p>
   <dl>
    <dt data-md>Polling
    <dd data-md>
     <p>Periodically, the software update system using the framework
  instructs the framework to check each repository for updates.  If
  the framework reports to the application code that there are
  updates, the application code determines whether it wants to
  download the updated target files.  Only target files that are
  trusted (referenced by properly signed and timely metadata) are
  made available by the framework.</p>
    <dt data-md>Fetching
    <dd data-md>
     <p>For each file that the application wants, it asks the framework to
  download the file.  The framework downloads the file and performs
  security checks to ensure that the downloaded file is exactly what
  is expected according to the signed metadata.  The application code
  is not given access to the file until the security checks have been
  completed.  The application asks the framework to copy the
  downloaded file to a location specified by the application.  At
  this point, the application has securely obtained the target file
  and can do with it whatever it wishes.</p>
   </dl>
   <h3 class="heading settled" data-level="2.1" id="roles-and-pki"><span class="secno">2.1. </span><span class="content">Roles and PKI</span><a class="self-link" href="#roles-and-pki"></a></h3>
   <p>In the discussion of roles that follows, it is important to remember that
the framework has been designed to allow a large amount of flexibility for
many different use cases.  For example, it is possible to use the framework
with a single key that is the only key used in the entire system.  This is
considered to be insecure but the flexibility is provided in order to meet
the needs of diverse use cases.</p>
   <p>There are four fundamental top-level roles in the framework:</p>
   <ul>
    <li data-md>
     <p>Root role</p>
    <li data-md>
     <p>Targets role</p>
    <li data-md>
     <p>Snapshot role</p>
    <li data-md>
     <p>Timestamp role</p>
   </ul>
   <p>There is also one optional top-level role:</p>
   <ul>
    <li data-md>
     <p>Mirrors role</p>
   </ul>
   <p>All roles can use one or more keys and require a threshold of signatures of
the role’s keys in order to trust a given metadata file.</p>
   <h4 class="heading settled" data-level="2.1.1" id="root"><span class="secno">2.1.1. </span><span class="content">Root role</span><a class="self-link" href="#root"></a></h4>
   <p>The root role delegates trust to specific keys trusted for all other
top-level roles used in the system.</p>
   <p>The client-side of the framework MUST ship with trusted root keys for each
configured repository.</p>
   <p>The root role’s private keys MUST be kept very secure and thus should be
kept offline.  If less than a threshold of Root keys are compromised, the
repository should revoke trust on the compromised keys.  This can be
accomplished with a normal rotation of root keys, covered in section <a href="#key-management-and-migration">§ 6.1 Key management and migration</a>. If a threshold of root keys is compromised,
the Root keys should be updated out-of-band, however, the threshold should
be chosen so that this is extremely unlikely.  In the unfortunate event that
a threshold of keys are compromised, it is safest to assume that attackers
have installed malware and taken over affected machines.  For this reason,
making it difficult for attackers to compromise all of the offline keys is
important because safely recovering from it is nearly impossible.</p>
   <h4 class="heading settled" data-level="2.1.2" id="targets"><span class="secno">2.1.2. </span><span class="content">Targets role</span><a class="self-link" href="#targets"></a></h4>
   <p>The targets role’s signature indicates which target files are trusted by
clients.  The targets role signs metadata that describes these files, not
the actual target files themselves.</p>
   <p>In addition, the targets role can delegate full or partial trust to other
roles.  Delegating trust means that the targets role indicates another role
(that is, another set of keys and the threshold required for trust) is
trusted to sign target file metadata.  Partial trust delegation is when the
delegated role is only trusted for some of the target files that the
delegating role is trusted for.</p>
   <p>Delegated roles can further delegate trust to other delegated
roles.  This provides for multiple levels of trust delegation where each
role can delegate full or partial trust for the target files they are
trusted for.  The delegating role in these cases is still trusted.  That is,
a role does not become untrusted when it has delegated trust.</p>
   <p>Any delegation can be revoked at any time: the delegating role needs only
to sign new metadata that no longer contains that delegation.</p>
   <h4 class="heading settled" data-level="2.1.3" id="snapshot"><span class="secno">2.1.3. </span><span class="content">Snapshot role</span><a class="self-link" href="#snapshot"></a></h4>
   <p>The snapshot role signs a metadata file that provides information about
the latest version of all targets metadata on the repository
(the top-level targets role and all delegated roles).  This information allows
clients to know which metadata files have been updated and also prevents
mix-and-match attacks.</p>
   <h4 class="heading settled" data-level="2.1.4" id="timestamp"><span class="secno">2.1.4. </span><span class="content">Timestamp role</span><a class="self-link" href="#timestamp"></a></h4>
   <p>To prevent an adversary from replaying an out-of-date signed metadata file
whose signature has not yet expired, an automated process periodically signs
a timestamped statement containing the hash of the snapshot file.  Even
though this timestamp key must be kept online, the risk posed to clients by
the compromise of this key is minimal.</p>
   <h4 class="heading settled" data-level="2.1.5" id="mirrors"><span class="secno">2.1.5. </span><span class="content">Mirrors role</span><a class="self-link" href="#mirrors"></a></h4>
   <p>Every repository has one or more mirrors from which files can be downloaded
by clients.  A software update system using the framework may choose to
hard-code the mirror information in their software or they may choose to use
mirror metadata files that can optionally be signed by a mirrors role.</p>
   <p>The importance of using signed mirror lists depends on the application and
the users of that application.  There is minimal risk to the application’s
security from being tricked into contacting the wrong mirrors.  This is
because the framework has very little trust in repositories.</p>
   <h3 class="heading settled" data-level="2.2" id="threat-model-and-analysis"><span class="secno">2.2. </span><span class="content">Threat model and analysis</span><a class="self-link" href="#threat-model-and-analysis"></a></h3>
   <p>We assume an adversary who can respond to client requests, whether by acting
as a man-in-the-middle or through compromising repository mirrors.  At
worst, such an adversary can deny updates to users if no good mirrors are
accessible.  An inability to obtain updates is noticed by the framework.</p>
   <p>If an adversary compromises enough keys to sign metadata, the best that can
be done is to limit the number of users who are affected.  The level to
which this threat is mitigated is dependent on how the application is using
the framework.  This includes whether different keys have been used for
different signing roles.</p>
   <p>A detailed threat analysis is outside the scope of this document.  This is
partly because the specific threat posted to clients in many situations is
largely determined by how the framework is being used.</p>
   <h3 class="heading settled" data-level="2.3" id="pouf-documents"><span class="secno">2.3. </span><span class="content">Protocol, Operations, Usage, and Format (POUF) documents</span><a class="self-link" href="#pouf-documents"></a></h3>
   <p>This specification purposefully leaves many implementation details,
including the metadata file formats, to the discretion of individual
implementations. These details do not affect the security of an
implementation, and so leaving them out of the specification allows this
document to support a greater variety of users. TUF implementers are
encouraged to document the wireline format and design decisions used in
their implementation as a POUF document. POUFs, as described in <a href="https://github.com/theupdateframework/taps/blob/master/tap11.md">TAP 11</a>,
allow different adopters to create interoperable implementations of TUF.
POUFs should follow the layout described in TAP 11 and may be made
publicly available in the <a href="https://github.com/theupdateframework/taps/tree/master/POUFs">TAP directory</a>.</p>
   <h2 class="heading settled" data-level="3" id="the-repository"><span class="secno">3. </span><span class="content">The repository</span><a class="self-link" href="#the-repository"></a></h2>
   <p>An application uses the framework to interact with one or more repositories.
A repository is a conceptual source of target files of interest to the
application.  Each repository MAY have one or more mirrors as the
providers of files to be downloaded.  For example, each mirror may specify a
different host where files can be downloaded from over HTTP.</p>
   <p>The mirrors can be full or partial mirrors as long as the application-side
of the framework can ultimately obtain all of the files it needs.  A mirror
is a partial mirror if it is missing files that a full mirror should have.
If a mirror is intended to only act as a partial mirror, the metadata and
target paths available from that mirror can be specified.</p>
   <p>Roles, trusted keys, and target files are completely separate between
repositories.  A multi-repository setup is a multi-root system.  When an
application uses the framework with multiple repositories, the framework
does not perform any "mixing" of the trusted content from each repository.
It is up to the application to determine the significance of the same or
different target files provided from separate repositories.</p>
   <h3 class="heading settled" data-level="3.1" id="repository-layout"><span class="secno">3.1. </span><span class="content">Repository layout</span><a class="self-link" href="#repository-layout"></a></h3>
   <p>The filesystem layout in the repository is used for two purposes:</p>
   <ul>
    <li data-md>
     <p>To give mirrors an easy way to mirror only some of the repository.</p>
    <li data-md>
     <p>To specify which parts of the repository a given role has authority
to sign/provide.</p>
   </ul>
   <h4 class="heading settled" data-level="3.1.1" id="target-files"><span class="secno">3.1.1. </span><span class="content">Target files</span><a class="self-link" href="#target-files"></a></h4>
   <p>The filenames and the directory structure of target files available from
a repository are not specified by the framework.  The names of these files
and directories are completely at the discretion of the application using
the framework.</p>
   <p>However, when <a data-link-type="dfn" href="#consistent_snapshot" id="ref-for-consistent_snapshot">CONSISTENT_SNAPSHOT</a>s are in use, there is a RECOMMENDED
mechanism for naming target files on the repository (see <a href="#consistent-snapshots">§ 6.2 Consistent snapshots</a>). If an application using the framework does not
follow these recommendations, but wishes to support self-contained consistent
snapshots the application MUST ensure that target files are persisted in a way
where each target file can be uniquely and consistently addressed.</p>
   <h4 class="heading settled" data-level="3.1.2" id="metadata-files"><span class="secno">3.1.2. </span><span class="content">Metadata files</span><a class="self-link" href="#metadata-files"></a></h4>
   <p>The filenames and directory structure of repository metadata are strictly
defined.  All metadata filenames will have an extension (EXT) based on the
metaformat, for example JSON metadata files would have an EXT of json.
The following are the metadata files of top-level roles relative
to the base URL of metadata available from a given repository mirror.</p>
   <dl>
    <dt data-md>/root.EXT
    <dd data-md>
     <p>Signed by the root keys; specifies trusted keys for the other
top-level roles.</p>
    <dt data-md>/snapshot.EXT
    <dd data-md>
     <p>Signed by the snapshot role’s keys.  Lists the version numbers of all
target metadata files: the top-level targets.EXT and all delegated
roles.</p>
    <dt data-md>/targets.EXT
    <dd data-md>
     <p>Signed by the target role’s keys.  Lists hashes and sizes of target
files. Specifies delegation information and trusted keys for delegated
target roles.</p>
    <dt data-md>/timestamp.EXT
    <dd data-md>
     <p>Signed by the timestamp role’s keys.  Lists hash(es), size, and version
number of the snapshot file.  This is the first and potentially only
file that needs to be downloaded when clients poll for the existence
of updates.</p>
    <dt data-md>/mirrors.EXT (optional)
    <dd data-md>
     <p>Signed by the mirrors role’s keys.  Lists information about available
mirrors and the content available from each mirror.</p>
   </dl>
   <h5 class="heading settled" data-level="3.1.2.1" id="metadata-files-for-targets-delegation"><span class="secno">3.1.2.1. </span><span class="content">Metadata files for targets delegation</span><a class="self-link" href="#metadata-files-for-targets-delegation"></a></h5>
   <p>When the targets role delegates trust to other roles, each delegated role
provides one signed metadata file.  As is the case with the directory
structure of top-level metadata, the delegated files are relative to the
base URL of metadata available from a given repository mirror.</p>
   <p>A delegated role file is located at:</p>
   <dl>
    <dt data-md>/DELEGATED_ROLE.EXT
    <dd data-md>
     <p>Where DELEGATED_ROLE is the name of the delegated role that has been
specified in targets.EXT.  If this role further delegates trust to a role
named ANOTHER_ROLE, that role’s signed metadata file is made available at:</p>
    <dt data-md>/ANOTHER_ROLE.EXT
    <dd data-md>
     <p>Delegated target roles are authorized by the keys listed in the directly
delegating target role.</p>
   </dl>
   <h2 class="heading settled" data-level="4" id="document-formats"><span class="secno">4. </span><span class="content">Document formats</span><a class="self-link" href="#document-formats"></a></h2>
   <p>All of the formats described below include the ability to add more
attribute-value fields to objects for backwards-compatible format changes.
Implementers who encounter undefined attribute-value pairs in the format
must include the data when calculating hashes or verifying signatures and must
preserve the data when re-serializing. If a backwards incompatible format change
is needed, a new filename can be used.</p>
   <h3 class="heading settled" data-level="4.1" id="metaformat"><span class="secno">4.1. </span><span class="content">Metaformat</span><a class="self-link" href="#metaformat"></a></h3>
   <p>Implementers of TUF may use any data format for metadata files as long as
all fields in this specification are included and TUF clients are able to
interpret them without ambiguity. Implementers should choose a data format
that allows for canonicalization, or one that will decode data
deterministically by default so that signatures can be accurately verified.
The chosen data format should be documented in the POUF of the implementation.
The examples in this document use a subset of the JSON object format, with
floating-point numbers omitted.  When calculating the digest of an
object, we use the "canonical JSON" subdialect as described at <a href="http://wiki.laptop.org/go/Canonical_JSON">Canonical JSON</a>.</p>
   <h3 class="heading settled" data-level="4.2" id="file-formats-general-principles"><span class="secno">4.2. </span><span class="content">File formats: general principles</span><a class="self-link" href="#file-formats-general-principles"></a></h3>
   <h4 class="heading settled" data-level="4.2.1" id="file-formats-object-format"><span class="secno">4.2.1. </span><span class="content">Object format</span><a class="self-link" href="#file-formats-object-format"></a></h4>
   <p>All signed metadata objects have the format:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"signed"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#role-role" id="ref-for-role-role">ROLE</a><c- p>,</c->
  <c- f>"signatures"</c-> <c- p>:</c-> <c- p>[</c->
    <c- p>{</c-> <c- f>"keyid"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#role-keyid" id="ref-for-role-keyid">KEYID</a><c- p>,</c->
      <c- f>"sig"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#signature" id="ref-for-signature">SIGNATURE</a> <c- p>}</c->
      <c- p>,</c-> ... <c- p>]</c->
<c- p>}</c->
</pre>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="role" data-dfn-type="dfn" data-noexport id="role-role">ROLE</dfn>
    <dd data-md>
     <p>A dictionary whose "_type" field describes the role type.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="role" data-dfn-type="dfn" data-noexport id="role-keyid">KEYID</dfn>
    <dd data-md>
     <p>The identifier of the key signing the <a data-link-type="dfn" href="#role-role" id="ref-for-role-role①">ROLE</a> object,
which is a hexdigest of the SHA-256 hash of the canonical form of the key.
The keyid MUST be unique in the "signatures" array: multiple
signatures with the same keyid are not allowed.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="signature">SIGNATURE</dfn>
    <dd data-md>
     <p>A hex-encoded signature of the canonical form of the metadata for <a data-link-type="dfn" href="#role-role" id="ref-for-role-role②">ROLE</a>.</p>
   </dl>
   <h4 class="heading settled" data-level="4.2.2" id="file-formats-keys"><span class="secno">4.2.2. </span><span class="content">Key objects</span><a class="self-link" href="#file-formats-keys"></a></h4>
   <p>All <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="key">KEY</dfn> objects have the format:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"keytype"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#keytype" id="ref-for-keytype">KEYTYPE</a><c- p>,</c->
  <c- f>"scheme"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#scheme" id="ref-for-scheme">SCHEME</a><c- p>,</c->
  <c- f>"keyval"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#keyval" id="ref-for-keyval">KEYVAL</a>
<c- p>}</c->
</pre>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="keytype">KEYTYPE</dfn>
    <dd data-md>
     <p>A string denoting a public key signature system, such as <a data-link-type="dfn" href="#keytype-rsa" id="ref-for-keytype-rsa">"rsa"</a>, <a data-link-type="dfn" href="#keytype-ed25519" id="ref-for-keytype-ed25519">"ed25519"</a>, and <a data-link-type="dfn" href="#keytype-ecdsa" id="ref-for-keytype-ecdsa">"ecdsa"</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="scheme">SCHEME</dfn>
    <dd data-md>
     <p>A string denoting a corresponding signature scheme.  For example: <a data-link-type="dfn" href="#scheme-rsassa-pss-sha256" id="ref-for-scheme-rsassa-pss-sha256">"rsassa-pss-sha256"</a>, <a data-link-type="dfn" href="#scheme-ed25519" id="ref-for-scheme-ed25519">"ed25519"</a>, and <a data-link-type="dfn" href="#scheme-ecdsa-sha2-nistp256" id="ref-for-scheme-ecdsa-sha2-nistp256">"ecdsa-sha2-nistp256"</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="keyval">KEYVAL</dfn>
    <dd data-md>
     <p>A dictionary containing the public portion of the key.</p>
   </dl>
   <p>The reference implementation defines three <a data-link-type="dfn" href="#keytype" id="ref-for-keytype①">KEYTYPE</a>s: <a data-link-type="dfn" href="#keytype-rsa" id="ref-for-keytype-rsa①">"rsa"</a>, <a data-link-type="dfn" href="#keytype-ed25519" id="ref-for-keytype-ed25519①">"ed25519"</a>, and <a data-link-type="dfn" href="#keytype-ecdsa" id="ref-for-keytype-ecdsa①">"ecdsa"</a>; and three signature <a data-link-type="dfn" href="#scheme" id="ref-for-scheme①">SCHEME</a>s: <a data-link-type="dfn" href="#scheme-rsassa-pss-sha256" id="ref-for-scheme-rsassa-pss-sha256①">"rsassa-pss-sha256"</a>, <a data-link-type="dfn" href="#scheme-ed25519" id="ref-for-scheme-ed25519①">"ed25519"</a>, and <a data-link-type="dfn" href="#scheme-ecdsa-sha2-nistp256" id="ref-for-scheme-ecdsa-sha2-nistp256①">"ecdsa-sha2-nistp256"</a>. These are documented below.</p>
   <p>TUF is not restricted to any particular signature <a data-link-type="dfn" href="#scheme" id="ref-for-scheme②">SCHEME</a>s, <a data-link-type="dfn" href="#keytype" id="ref-for-keytype②">KEYTYPE</a>s, or cryptographic library. Adopters can define and use any
particular <a data-link-type="dfn" href="#keytype" id="ref-for-keytype③">KEYTYPE</a>, signing <a data-link-type="dfn" href="#scheme" id="ref-for-scheme③">SCHEME</a>, and cryptographic library.</p>
   <p>Implementing the <a data-link-type="dfn" href="#keytype" id="ref-for-keytype④">KEYTYPE</a>s and <a data-link-type="dfn" href="#scheme" id="ref-for-scheme④">SCHEME</a>s below is RECOMMENDED for
all implementations, as this enables interoperability. Conversely,
implementations SHOULD NOT implement the <a data-link-type="dfn" href="#keytype" id="ref-for-keytype⑤">KEYTYPE</a>s and <a data-link-type="dfn" href="#scheme" id="ref-for-scheme⑤">SCHEME</a>s
that are defined in a different manner than specified, so as to avoid confusion
across implementations.</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="scheme" data-dfn-type="dfn" data-noexport id="scheme-rsassa-pss-sha256">"rsassa-pss-sha256"</dfn>
    <dd data-md>
     <p>RSA Probabilistic signature scheme with appendix. The underlying hash
function is SHA256. <a href="https://tools.ietf.org/html/rfc3447#page-29">https://tools.ietf.org/html/rfc3447#page-29 </a></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="scheme" data-dfn-type="dfn" data-noexport id="scheme-ed25519">"ed25519"</dfn>
    <dd data-md>
     <p>Elliptic curve digital signature algorithm based on Twisted Edwards curves. <a href="https://ed25519.cr.yp.to/">https://ed25519.cr.yp.to/</a></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="scheme" data-dfn-type="dfn" data-noexport id="scheme-ecdsa-sha2-nistp256">"ecdsa-sha2-nistp256"</dfn>
    <dd data-md>
     <p>Elliptic Curve Digital Signature Algorithm with NIST P-256 curve signing
and SHA-256 hashing. <a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm">https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm </a></p>
   </dl>
   <p>The <dfn class="dfn-paneled" data-dfn-for="keytype" data-dfn-type="dfn" data-noexport id="keytype-rsa">"rsa"</dfn> format is:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"keytype"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#keytype-rsa" id="ref-for-keytype-rsa②"><c- u>"rsa"</c-></a><c- p>,</c->
  <c- f>"scheme"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#scheme-rsassa-pss-sha256" id="ref-for-scheme-rsassa-pss-sha256②"><c- u>"rsassa-pss-sha256"</c-></a><c- p>,</c->
  <c- f>"keyval"</c-> <c- p>:</c-> <c- p>{</c->
    <c- f>"public"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#keyval-rsa-public" id="ref-for-keyval-rsa-public">PUBLIC</a>
  <c- p>}</c->
<c- p>}</c->
</pre>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="keyval-rsa" data-dfn-type="dfn" data-noexport id="keyval-rsa-public">PUBLIC</dfn>
    <dd data-md>
     <p>PEM format and a string.  All RSA keys MUST be at least 2048 bits.</p>
   </dl>
   <p>The <dfn class="dfn-paneled" data-dfn-for="keytype" data-dfn-type="dfn" data-noexport id="keytype-ed25519">"ed25519"</dfn> format is:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"keytype"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#keytype-ed25519" id="ref-for-keytype-ed25519②"><c- u>"ed25519"</c-></a><c- p>,</c->
  <c- f>"scheme"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#scheme-ed25519" id="ref-for-scheme-ed25519②"><c- u>"ed25519"</c-></a><c- p>,</c->
  <c- f>"keyval"</c-> <c- p>:</c-> <c- p>{</c->
    <c- f>"public"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#keyval-ed25519-public" id="ref-for-keyval-ed25519-public">PUBLIC</a>
  <c- p>}</c->
<c- p>}</c->
</pre>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="keyval-ed25519" data-dfn-type="dfn" data-noexport id="keyval-ed25519-public">PUBLIC</dfn>
    <dd data-md>
     <p>64-byte hex encoded string.</p>
   </dl>
   <p>The <dfn class="dfn-paneled" data-dfn-for="keytype" data-dfn-type="dfn" data-noexport id="keytype-ecdsa">"ecdsa"</dfn> format is:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"keytype"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#keytype-ecdsa" id="ref-for-keytype-ecdsa②"><c- u>"ecdsa"</c-></a><c- p>,</c->
  <c- f>"scheme"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#scheme-ecdsa-sha2-nistp256" id="ref-for-scheme-ecdsa-sha2-nistp256②"><c- u>"ecdsa-sha2-nistp256"</c-></a><c- p>,</c->
  <c- f>"keyval"</c-> <c- p>:</c-> <c- p>{</c->
    <c- f>"public"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#keyval-ecdsa-public" id="ref-for-keyval-ecdsa-public">PUBLIC</a>
  <c- p>}</c->
<c- p>}</c->
</pre>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="keyval-ecdsa" data-dfn-type="dfn" data-noexport id="keyval-ecdsa-public">PUBLIC</dfn>
    <dd data-md>
     <p>PEM format and a string.</p>
   </dl>
   <h4 class="heading settled" data-level="4.2.3" id="file-formats-date-time"><span class="secno">4.2.3. </span><span class="content">Date-time</span><a class="self-link" href="#file-formats-date-time"></a></h4>
   <p>Metadata <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="date-time">date-time</dfn> follows the ISO 8601 standard.  The expected
format of the combined date and time string is "YYYY-MM-DDTHH:MM:SSZ".  Time is
always in UTC, and the "Z" time zone designator is attached to indicate a
zero UTC offset.  An example <a data-link-type="dfn" href="#date-time" id="ref-for-date-time">date-time</a> string is "1985-10-21T01:21:00Z".</p>
   <h3 class="heading settled" data-level="4.3" id="file-formats-root"><span class="secno">4.3. </span><span class="content">File formats: root.json</span><a class="self-link" href="#file-formats-root"></a></h3>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="rootjson">root.json</dfn> file is signed by the root role’s keys.  It indicates
which keys are authorized for all top-level roles, including the root
role itself.  Revocation and replacement of top-level role keys, including
for the root role, is done by changing the keys listed for the roles in
this file.</p>
   <p>The "signed" portion of <a data-link-type="dfn" href="#rootjson" id="ref-for-rootjson">root.json</a> is as follows:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"_type"</c-> <c- p>:</c-> <c- u>"root"</c-><c- p>,</c->
  <c- f>"spec_version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#spec_version" id="ref-for-spec_version">SPEC_VERSION</a><c- p>,</c->
  <c- f>"consistent_snapshot"</c-><c- p>:</c-> <a data-link-type="dfn" href="#consistent_snapshot" id="ref-for-consistent_snapshot①">CONSISTENT_SNAPSHOT</a><c- p>,</c->
  <c- f>"version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#role-version" id="ref-for-role-version">VERSION</a><c- p>,</c->
  <c- f>"expires"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#expires" id="ref-for-expires">EXPIRES</a><c- p>,</c->
  <c- f>"keys"</c-> <c- p>:</c-> <c- p>{</c->
    <a data-link-type="dfn" href="#root-keyid" id="ref-for-root-keyid">KEYID</a> <c- p>:</c-> <a data-link-type="dfn" href="#key" id="ref-for-key">KEY</a><c- p>,</c->
    ...
  <c- p>},</c->
  <c- f>"roles"</c-> <c- p>:</c-> <c- p>{</c->
    <a data-link-type="dfn" href="#root-role" id="ref-for-root-role">ROLE</a> <c- p>:</c-> <c- p>{</c->
      <c- f>"keyids"</c-> <c- p>:</c-> <c- p>[</c->
        <a data-link-type="dfn" href="#root-keyid" id="ref-for-root-keyid①">KEYID</a><c- p>,</c->
        ...
      <c- p>]</c-> <c- p>,</c->
      <c- f>"threshold"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#threshold" id="ref-for-threshold">THRESHOLD</a>
    <c- p>},</c->
    ...
  <c- p>}</c->
<c- p>}</c->
</pre>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="spec_version">SPEC_VERSION</dfn>
    <dd data-md>
     <p>A string that contains the version number of the TUF
specification.  Its format follows the <a href="https://semver.org/spec/v2.0.0.html">Semantic Versioning 2.0.0
(semver)</a> specification. Metadata is
written according to version "spec_version" of the specification, and
clients MUST verify that "spec_version" matches the expected version number.
Adopters are free to determine what is considered a match (e.g., the version
number exactly, or perhaps only the major version number (major.minor.fix).</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="consistent_snapshot">CONSISTENT_SNAPSHOT</dfn>
    <dd data-md>
     <p>An OPTIONAL boolean indicating whether the repository supports
consistent snapshots. This field is OPTIONAL for backwards compatibility with
old metadata. New implementations SHOULD include it. Section <a href="#consistent-snapshots">§ 6.2 Consistent snapshots</a> goes into more detail on the consequences of
enabling this setting on a repository.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="role" data-dfn-type="dfn" data-noexport id="role-version">VERSION</dfn>
    <dd data-md>
     <p>An integer that is greater than 0.  Clients MUST NOT replace a
metadata file with a version number less than the one currently trusted.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="expires">EXPIRES</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#date-time" id="ref-for-date-time①">date-time</a> string indicating when metadata should be considered
expired and no longer trusted by clients.  Clients MUST NOT trust an
expired file.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="root" data-dfn-type="dfn" data-noexport id="root-role">ROLE</dfn>
    <dd data-md>
     <p>One of "root", "snapshot", "targets", "timestamp", or "mirrors".
A role for each of "root", "snapshot", "timestamp", and "targets" MUST be
specified in the roles object. The role of "mirror" is OPTIONAL.  If not
specified, the mirror list will not need to be signed if mirror lists are
being used.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="root" data-dfn-type="dfn" data-noexport id="root-keyid">KEYID</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#role-keyid" id="ref-for-role-keyid①">KEYID</a>, which MUST be correct for the specified KEY.
Clients MUST calculate each <a data-link-type="dfn" href="#role-keyid" id="ref-for-role-keyid②">KEYID</a> to verify this is
correct for the associated key.  Clients MUST ensure that for any <a data-link-type="dfn" href="#role-keyid" id="ref-for-role-keyid③">KEYID</a> represented in this key list and in other files,
only one unique key has that <a data-link-type="dfn" href="#role-keyid" id="ref-for-role-keyid④">KEYID</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="threshold">THRESHOLD</dfn>
    <dd data-md>
     <p>An integer number of keys of that role whose signatures are required in
order to consider a file as being properly signed by that role.</p>
   </dl>
   <div class="example" id="example-root.json">
    <a class="self-link" href="#example-root.json"></a> A <a data-link-type="dfn" href="#rootjson" id="ref-for-rootjson①">root.json</a> example file: 
<pre class="highlight"><c- p>{</c->
  <c- f>"signatures"</c-><c- p>:</c-> <c- p>[</c->
    <c- p>{</c->
      <c- f>"keyid"</c-><c- p>:</c-> <c- u>"cb3fbd83df4ba2471a736b065650878280964a98843ec13b457a99b2a21cc3b4"</c-><c- p>,</c->
      <c- f>"sig"</c-><c- p>:</c-> <c- u>"a312b9c3cb4a1b693e8ebac5ee1ca9cc01f2661c14391917dcb111517f72370809</c->
<c- u>              f32c890c6b801e30158ac4efe0d4d87317223077784c7a378834249d048306"</c->
    <c- p>}</c->
  <c- p>],</c->
  <c- f>"signed"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"_type"</c-><c- p>:</c-> <c- u>"root"</c-><c- p>,</c->
    <c- f>"spec_version"</c-><c- p>:</c-> <c- u>"1.0.0"</c-><c- p>,</c->
    <c- f>"consistent_snapshot"</c-><c- p>:</c-> <c- kc>false</c-><c- p>,</c->
    <c- f>"expires"</c-><c- p>:</c-> <c- u>"2030-01-01T00:00:00Z"</c-><c- p>,</c->
    <c- f>"keys"</c-><c- p>:</c-> <c- p>{</c->
      <c- f>"1bf1c6e3cdd3d3a8420b19199e27511999850f4b376c4547b2f32fba7e80fca3"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"keytype"</c-><c- p>:</c-> <c- u>"ed25519"</c-><c- p>,</c->
        <c- f>"scheme"</c-><c- p>:</c-> <c- u>"ed25519"</c-><c- p>,</c->
        <c- f>"keyval"</c-><c- p>:</c-> <c- p>{</c->
          <c- f>"public"</c-><c- p>:</c-> <c- u>"72378e5bc588793e58f81c8533da64a2e8f1565c1fcc7f253496394ffc52542c"</c->
        <c- p>}</c->
      <c- p>},</c->
      <c- f>"135c2f50e57ff11e744d234a62cebad8c38daf399604a7655661cc9199c69164"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"keytype"</c-><c- p>:</c-> <c- u>"ed25519"</c-><c- p>,</c->
        <c- f>"scheme"</c-><c- p>:</c-> <c- u>"ed25519"</c-><c- p>,</c->
        <c- f>"keyval"</c-><c- p>:</c-> <c- p>{</c->
          <c- f>"public"</c-><c- p>:</c-> <c- u>"68ead6e54a43f8f36f9717b10669d1ef0ebb38cee6b05317669341309f1069cb"</c->
        <c- p>}</c->
      <c- p>},</c->
      <c- f>"cb3fbd83df4ba2471a736b065650878280964a98843ec13b457a99b2a21cc3b4"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"keytype"</c-><c- p>:</c-> <c- u>"ed25519"</c-><c- p>,</c->
        <c- f>"scheme"</c-><c- p>:</c-> <c- u>"ed25519"</c-><c- p>,</c->
        <c- f>"keyval"</c-><c- p>:</c-> <c- p>{</c->
          <c- f>"public"</c-><c- p>:</c-> <c- u>"66dd78c5c2a78abc6fc6b267ff1a8017ba0e8bfc853dd97af351949bba021275"</c->
        <c- p>}</c->
      <c- p>},</c->
      <c- f>"66676daa73bdfb4804b56070c8927ae491e2a6c2314f05b854dea94de8ff6bfc"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"keytype"</c-><c- p>:</c-> <c- u>"ed25519"</c-><c- p>,</c->
        <c- f>"scheme"</c-><c- p>:</c-> <c- u>"ed25519"</c-><c- p>,</c->
        <c- f>"keyval"</c-><c- p>:</c-> <c- p>{</c->
          <c- f>"public"</c-><c- p>:</c-> <c- u>"01c61f8dc7d77fcef973f4267927541e355e8ceda757e2c402818dad850f856e"</c->
        <c- p>}</c->
      <c- p>}</c->
    <c- p>},</c->
    <c- f>"roles"</c-><c- p>:</c-> <c- p>{</c->
      <c- f>"root"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"keyids"</c-><c- p>:</c-> <c- p>[</c->
          <c- u>"cb3fbd83df4ba2471a736b065650878280964a98843ec13b457a99b2a21cc3b4"</c->
        <c- p>],</c->
        <c- f>"threshold"</c-><c- p>:</c-> <c- mi>1</c->
      <c- p>},</c->
      <c- f>"snapshot"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"keyids"</c-><c- p>:</c-> <c- p>[</c->
          <c- u>"66676daa73bdfb4804b56070c8927ae491e2a6c2314f05b854dea94de8ff6bfc"</c->
        <c- p>],</c->
        <c- f>"threshold"</c-><c- p>:</c-> <c- mi>1</c->
      <c- p>},</c->
      <c- f>"targets"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"keyids"</c-><c- p>:</c-> <c- p>[</c->
          <c- u>"135c2f50e57ff11e744d234a62cebad8c38daf399604a7655661cc9199c69164"</c->
        <c- p>],</c->
        <c- f>"threshold"</c-><c- p>:</c-> <c- mi>1</c->
      <c- p>},</c->
      <c- f>"timestamp"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"keyids"</c-><c- p>:</c-> <c- p>[</c->
          <c- u>"1bf1c6e3cdd3d3a8420b19199e27511999850f4b376c4547b2f32fba7e80fca3"</c->
        <c- p>],</c->
        <c- f>"threshold"</c-><c- p>:</c-> <c- mi>1</c->
      <c- p>}</c->
    <c- p>},</c->
    <c- f>"version"</c-><c- p>:</c-> <c- mi>1</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="4.4" id="file-formats-snapshot"><span class="secno">4.4. </span><span class="content">File formats: snapshot.json</span><a class="self-link" href="#file-formats-snapshot"></a></h3>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="snapshotjson">snapshot.json</dfn> file is signed by the snapshot role. It MUST list the
version numbers of the top-level targets metadata and all delegated targets
metadata. It MAY also list their lengths and file hashes.</p>
   <p>The "signed" portion of <a data-link-type="dfn" href="#snapshotjson" id="ref-for-snapshotjson">snapshot.json</a> is as follows:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"_type"</c-> <c- p>:</c-> <c- u>"snapshot"</c-><c- p>,</c->
  <c- f>"spec_version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#spec_version" id="ref-for-spec_version①">SPEC_VERSION</a><c- p>,</c->
  <c- f>"version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#role-version" id="ref-for-role-version①">VERSION</a><c- p>,</c->
  <c- f>"expires"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#expires" id="ref-for-expires①">EXPIRES</a><c- p>,</c->
  <c- f>"meta"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#metafiles" id="ref-for-metafiles">METAFILES</a>
<c- p>}</c->
</pre>
   <p><a data-link-type="dfn" href="#spec_version" id="ref-for-spec_version②">SPEC_VERSION</a>, <a data-link-type="dfn" href="#role-version" id="ref-for-role-version②">VERSION</a> and <a data-link-type="dfn" href="#expires" id="ref-for-expires②">EXPIRES</a> are the same
as is described for the <a data-link-type="dfn" href="#rootjson" id="ref-for-rootjson②">root.json</a> file.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="metafiles">METAFILES</dfn> is an object whose format is the following:</p>
<pre class="highlight"><c- p>{</c->
  <a data-link-type="dfn" href="#snapshot-metapath" id="ref-for-snapshot-metapath">METAPATH</a> <c- p>:</c-> <c- p>{</c->
    <c- f>"version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#metapath-version" id="ref-for-metapath-version">VERSION</a><c- p>,</c->
    (<c- f>"length"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#metapath-length" id="ref-for-metapath-length">LENGTH</a><c- p>,</c->)
    (<c- f>"hashes"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#metapath-hashes" id="ref-for-metapath-hashes">HASHES</a>)
  <c- p>},</c->
  ...
<c- p>}</c->
</pre>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="snapshot" data-dfn-type="dfn" data-noexport id="snapshot-metapath">METAPATH</dfn>
    <dd data-md>
     <p>A string giving the file path of the metadata on the repository relative to
the metadata base URL.  For <a data-link-type="dfn" href="#snapshotjson" id="ref-for-snapshotjson①">snapshot.json</a>, these are top-level targets
metadata and delegated targets metadata.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="metapath" data-dfn-type="dfn" data-noexport id="metapath-version">VERSION</dfn>
    <dd data-md>
     <p>An integer version number as shown in the metadata file at <a data-link-type="dfn" href="#snapshot-metapath" id="ref-for-snapshot-metapath①">METAPATH</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="metapath" data-dfn-type="dfn" data-noexport id="metapath-length">LENGTH</dfn>
    <dd data-md>
     <p>An integer length in bytes of the metadata file at <a data-link-type="dfn" href="#snapshot-metapath" id="ref-for-snapshot-metapath②">METAPATH</a>. It is OPTIONAL and can be omitted to reduce
the snapshot metadata file size.  In that case the client MUST use a custom
download limit for the listed metadata.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="metapath" data-dfn-type="dfn" data-noexport id="metapath-hashes">HASHES</dfn>
    <dd data-md>
     <p>A dictionary that specifies one or more hashes of the metadata
file at <a data-link-type="dfn" href="#snapshot-metapath" id="ref-for-snapshot-metapath③">METAPATH</a>, with the cryptographic hash
function as key and the value as <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="hash">HASH</dfn>, the hexdigest of the
cryptographic function computed on the metadata file at <a data-link-type="dfn" href="#snapshot-metapath" id="ref-for-snapshot-metapath④">METAPATH</a>.  For example: <code>{ "sha256": HASH, ... }</code>. <a data-link-type="dfn" href="#metapath-hashes" id="ref-for-metapath-hashes①">HASHES</a> is OPTIONAL and can be omitted to reduce the
snapshot metadata file size.  In that case the repository MUST guarantee
that <a data-link-type="dfn" href="#metapath-version" id="ref-for-metapath-version①">VERSION</a> alone unambiguously identifies
the metadata at <a data-link-type="dfn" href="#snapshot-metapath" id="ref-for-snapshot-metapath⑤">METAPATH</a>.</p>
   </dl>
   <div class="example" id="example-snapshot.json">
    <a class="self-link" href="#example-snapshot.json"></a> A <a data-link-type="dfn" href="#snapshotjson" id="ref-for-snapshotjson②">snapshot.json</a> example file: 
<pre class="highlight"><c- p>{</c->
  <c- f>"signatures"</c-><c- p>:</c-> <c- p>[</c->
    <c- p>{</c->
      <c- f>"keyid"</c-><c- p>:</c-> <c- u>"66676daa73bdfb4804b56070c8927ae491e2a6c2314f05b854dea94de8ff6bfc"</c-><c- p>,</c->
      <c- f>"sig"</c-><c- p>:</c-> <c- u>"f7f03b13e3f4a78a23561419fc0dd741a637e49ee671251be9f8f3fceedfc112e4</c->
<c- u>              4ee3aaff2278fad9164ab039118d4dc53f22f94900dae9a147aa4d35dcfc0f"</c->
    <c- p>}</c->
  <c- p>],</c->
  <c- f>"signed"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"_type"</c-><c- p>:</c-> <c- u>"snapshot"</c-><c- p>,</c->
    <c- f>"spec_version"</c-><c- p>:</c-> <c- u>"1.0.0"</c-><c- p>,</c->
    <c- f>"expires"</c-><c- p>:</c-> <c- u>"2030-01-01T00:00:00Z"</c-><c- p>,</c->
    <c- f>"meta"</c-><c- p>:</c-> <c- p>{</c->
      <c- f>"targets.json"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"version"</c-><c- p>:</c-> <c- mi>1</c->
      <c- p>},</c->
      <c- f>"project1.json"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"version"</c-><c- p>:</c-> <c- mi>1</c-><c- p>,</c->
        <c- f>"hashes"</c-><c- p>:</c-> <c- p>{</c->
          <c- f>"sha256"</c-><c- p>:</c-> <c- u>"f592d072e1193688a686267e8e10d7257b4ebfcf28133350dae88362d82a0c8a"</c->
        <c- p>}</c->
      <c- p>},</c->
      <c- f>"project2.json"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"version"</c-><c- p>:</c-> <c- mi>1</c-><c- p>,</c->
        <c- f>"length"</c-><c- p>:</c-> <c- mi>604</c-><c- p>,</c->
        <c- f>"hashes"</c-><c- p>:</c-> <c- p>{</c->
          <c- f>"sha256"</c-><c- p>:</c-> <c- u>"1f812e378264c3085bb69ec5f6663ed21e5882bbece3c3f8a0e8479f205ffb91"</c->
        <c- p>}</c->
      <c- p>}</c->
    <c- p>},</c->
    <c- f>"version"</c-><c- p>:</c-> <c- mi>1</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="4.5" id="file-formats-targets"><span class="secno">4.5. </span><span class="content">File formats: targets.json and delegated target roles</span><a class="self-link" href="#file-formats-targets"></a></h3>
   <p>The "signed" portion of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="targetsjson">targets.json</dfn> is as follows:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"_type"</c-> <c- p>:</c-> <c- u>"targets"</c-><c- p>,</c->
  <c- f>"spec_version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#spec_version" id="ref-for-spec_version③">SPEC_VERSION</a><c- p>,</c->
  <c- f>"version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#role-version" id="ref-for-role-version③">VERSION</a><c- p>,</c->
  <c- f>"expires"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#expires" id="ref-for-expires③">EXPIRES</a><c- p>,</c->
  <c- f>"targets"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#targets-obj-targets" id="ref-for-targets-obj-targets">TARGETS</a><c- p>,</c->
  (<c- f>"delegations"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#delegations" id="ref-for-delegations">DELEGATIONS</a>)
<c- p>}</c->
</pre>
   <p><a data-link-type="dfn" href="#spec_version" id="ref-for-spec_version④">SPEC_VERSION</a>, <a data-link-type="dfn" href="#role-version" id="ref-for-role-version④">VERSION</a> and <a data-link-type="dfn" href="#expires" id="ref-for-expires④">EXPIRES</a> are the same
as is described for the <a data-link-type="dfn" href="#rootjson" id="ref-for-rootjson③">root.json</a> file.</p>
   <p><dfn class="dfn-paneled" data-dfn-for="targets-obj" data-dfn-type="dfn" data-noexport id="targets-obj-targets">TARGETS</dfn> is an object whose format is the following:</p>
<pre class="highlight"><c- p>{</c->
  <a data-link-type="dfn" href="#targetpath" id="ref-for-targetpath">TARGETPATH</a> <c- p>:</c-> <c- p>{</c->
      <c- f>"length"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#targets-obj-length" id="ref-for-targets-obj-length">LENGTH</a><c- p>,</c->
      <c- f>"hashes"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#targets-obj-hashes" id="ref-for-targets-obj-hashes">HASHES</a><c- p>,</c->
      (<c- f>"custom"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#custom" id="ref-for-custom">CUSTOM</a>) <c- p>}</c->
  <c- p>,</c-> ...
<c- p>}</c->
</pre>
   <dl>
    <dt data-md><a data-link-type="dfn" href="#targets-obj-targets" id="ref-for-targets-obj-targets①">TARGETS</a>
    <dd data-md>
     <p>Each key of the <a data-link-type="dfn" href="#targets-obj-targets" id="ref-for-targets-obj-targets②">TARGETS</a> object is a <a data-link-type="dfn" href="#targetpath" id="ref-for-targetpath①">TARGETPATH</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="targetpath">TARGETPATH</dfn>
    <dd data-md>
     <p>A string giving the path to a file that is relative to a mirror’s base URL
of targets.  To avoid surprising behavior when resolving paths, it is
RECOMMENDED that a <a data-link-type="dfn" href="#targetpath" id="ref-for-targetpath②">TARGETPATH</a> uses the forward slash (/) as directory
separator and does not start with a directory separator. The recommendation
for <a data-link-type="dfn" href="#targetpath" id="ref-for-targetpath③">TARGETPATH</a> aligns with the <a href="https://url.spec.whatwg.org/#path-relative-url-string">"path-relative-URL string"
definition</a> in the
WHATWG URL specification.</p>
     <p>It is allowed to have a <a data-link-type="dfn" href="#targets-obj-targets" id="ref-for-targets-obj-targets③">TARGETS</a> object with no <a data-link-type="dfn" href="#targetpath" id="ref-for-targetpath④">TARGETPATH</a> elements.  This can be used to indicate that no target
files are available.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="targets-obj" data-dfn-type="dfn" data-noexport id="targets-obj-length">LENGTH</dfn>
    <dd data-md>
     <p>An integer length in bytes of the target file at <a data-link-type="dfn" href="#targetpath" id="ref-for-targetpath⑤">TARGETPATH</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="targets-obj" data-dfn-type="dfn" data-noexport id="targets-obj-hashes">HASHES</dfn>
    <dd data-md>
     <p>A dictionary that specifies one or more hashes of the target file at <a data-link-type="dfn" href="#targetpath" id="ref-for-targetpath⑥">TARGETPATH</a>, with a string describing the cryptographic hash function
as key and <a data-link-type="dfn" href="#hash" id="ref-for-hash">HASH</a> as defined for <a data-link-type="dfn" href="#metafiles" id="ref-for-metafiles①">METAFILES</a>.  For example: <code>{ "sha256": HASH, ... }</code>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="custom">CUSTOM</dfn>
    <dd data-md>
     <p>An object.  If defined, the elements and values of the <a data-link-type="dfn" href="#custom" id="ref-for-custom①">CUSTOM</a> object
will be made available to the client application.  The format of the <a data-link-type="dfn" href="#custom" id="ref-for-custom②">CUSTOM</a> object is opaque to the framework, which only needs to know
that the "custom" attribute maps to an object.  The <a data-link-type="dfn" href="#custom" id="ref-for-custom③">CUSTOM</a> object
may include version numbers, dependencies, requirements, or any other data
that the application wants to include to describe the file at <a data-link-type="dfn" href="#targetpath" id="ref-for-targetpath⑦">TARGETPATH</a>.  The application may use this information to guide
download decisions.</p>
   </dl>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="delegations">DELEGATIONS</dfn> is an OPTIONAL object and if defined it has the following
format:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"keys"</c-> <c- p>:</c-> <c- p>{</c->
      <a data-link-type="dfn" href="#role-keyid" id="ref-for-role-keyid⑤">KEYID</a> <c- p>:</c-> <a data-link-type="dfn" href="#key" id="ref-for-key①">KEY</a><c- p>,</c->
      ...
  <c- p>},</c->
  <c- f>"roles"</c-> <c- p>:</c-> <c- p>[</c->
    <c- p>{</c->
      <c- f>"name"</c-><c- p>:</c-> <a data-link-type="dfn" href="#rolename" id="ref-for-rolename">ROLENAME</a><c- p>,</c->
      <c- f>"keyids"</c-> <c- p>:</c-> <c- p>[</c-> <a data-link-type="dfn" href="#role-keyid" id="ref-for-role-keyid⑥">KEYID</a><c- p>,</c-> ... <c- p>]</c-> <c- p>,</c->
      <c- f>"threshold"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#threshold" id="ref-for-threshold①">THRESHOLD</a><c- p>,</c->
      (<a data-link-type="dfn" href="#path_hash_prefixes" id="ref-for-path_hash_prefixes"><c- f>"path_hash_prefixes"</c-></a> <c- p>:</c-> <c- p>[</c-> <a data-link-type="dfn" href="#hex_digest" id="ref-for-hex_digest">HEX_DIGEST</a><c- p>,</c-> ... <c- p>]</c-> |
      <a data-link-type="dfn" href="#delegation-role-paths" id="ref-for-delegation-role-paths"><c- f>"paths"</c-></a> <c- p>:</c-> <c- p>[</c-> <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern">PATHPATTERN</a><c- p>,</c-> ... <c- p>]</c->)<c- p>,</c->
      <c- f>"terminating"</c-><c- p>:</c-> <a data-link-type="dfn" href="#terminating" id="ref-for-terminating">TERMINATING</a><c- p>,</c->
    <c- p>},</c->
    ...
  <c- p>]</c->
<c- p>}</c->
</pre>
   <p><a data-link-type="dfn" href="#root-keyid" id="ref-for-root-keyid②">KEYID</a> and <a data-link-type="dfn" href="#key" id="ref-for-key②">KEY</a> are the same as is described for the <a data-link-type="dfn" href="#rootjson" id="ref-for-rootjson④">root.json</a> file.</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="rolename">ROLENAME</dfn>
    <dd data-md>
     <p>A string giving the name of the delegated role.  For example, "projects".
The rolename MUST be unique in the delegations object: multiple roles with
the same rolename are not allowed within a <a data-link-type="dfn" href="#delegations" id="ref-for-delegations①">DELEGATIONS</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="terminating">TERMINATING</dfn>
    <dd data-md>
     <p>A boolean indicating whether subsequent delegations should be considered
if a matching target is not found in this delegation.</p>
     <p>As explained in the <a href="https://theupdateframework.io/papers/protect-community-repositories-nsdi2016.pdf">Diplomat paper </a>,
terminating delegations instruct the client not to consider future trust
statements that match this delegation’s pattern, which stops the delegation
processing once this delegation (and its descendants) have been processed.
A terminating delegation for a package causes any further statements about a
package that are not made by the delegated party or its descendants to be
ignored.</p>
   </dl>
   <p>The <a data-link-type="dfn" href="#path_hash_prefixes" id="ref-for-path_hash_prefixes①">"path_hash_prefixes"</a> and <a data-link-type="dfn" href="#delegation-role-paths" id="ref-for-delegation-role-paths①">"paths"</a> attributes are OPTIONAL, if used, exactly one of them should be set.</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="path_hash_prefixes">"path_hash_prefixes"</dfn>
    <dd data-md>
     <p>A list of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="hex_digest">HEX_DIGEST</dfn>s used to succinctly describe a set of target
paths. Specifically, each HEX_DIGEST in <a data-link-type="dfn" href="#path_hash_prefixes" id="ref-for-path_hash_prefixes②">"path_hash_prefixes"</a> describes a set of target paths; therefore, <a data-link-type="dfn" href="#path_hash_prefixes" id="ref-for-path_hash_prefixes③">"path_hash_prefixes"</a> is
the union over each prefix of its set of target paths.  The target paths
must meet this condition: each target path, when hashed with the SHA-256
hash function to produce a 64-byte hexadecimal digest
(HEX_DIGEST), must share the same prefix as one of the prefixes
in <a data-link-type="dfn" href="#path_hash_prefixes" id="ref-for-path_hash_prefixes④">"path_hash_prefixes"</a>.  This is useful to split a large number of
targets into separate bins identified by consistent hashing.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="delegation-role" data-dfn-type="dfn" data-noexport id="delegation-role-paths">"paths"</dfn>
    <dd data-md>
     <p>A list of strings, where each string is a <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern①">PATHPATTERN</a> describing a
path that the delegated role is trusted to provide.  Clients MUST check that
a target is in one of the trusted paths of all roles in a delegation chain,
not just in a trusted path of the role that describes the target file.</p>
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="pathpattern">PATHPATTERN</dfn> supports the Unix shell pattern matching convention
for paths (<a href="https://man7.org/linux/man-pages/man7/glob.7.html">glob</a>bing
pathnames). Its format may either indicate a path to a single file, or to
multiple files with the use of shell-style wildcards (<code>*</code> or <code>?</code>).
To avoid surprising behavior when matching targets with <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern②">PATHPATTERN</a>,
it is RECOMMENDED that <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern③">PATHPATTERN</a> uses the forward slash (<code>/</code>) as
directory separator and does not start with a directory separator, as is
also recommended for <a data-link-type="dfn" href="#targetpath" id="ref-for-targetpath⑧">TARGETPATH</a>. A path separator in a path SHOULD
NOT be matched by a wildcard in the <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern④">PATHPATTERN</a>.</p>
     <p>Some example <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern⑤">PATHPATTERN</a>s and expected matches:</p>
     <ul>
      <li data-md>
       <p>a <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern⑥">PATHPATTERN</a> of <code>"targets/*.tgz"</code> would match file paths <code>"targets/foo.tgz"</code> and <code>"targets/bar.tgz"</code>, but not <code>"targets/foo.txt"</code>.</p>
      <li data-md>
       <p>a <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern⑦">PATHPATTERN</a> of <code>"foo-version-?.tgz"</code> matches <code>"foo-version-2.tgz"</code> and <code>"foo-version-a.tgz"</code>, but not <code>"foo-version-alpha.tgz"</code>.</p>
      <li data-md>
       <p>a <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern⑧">PATHPATTERN</a> of <code>"*.tgz"</code> would match <code>"foo.tgz"</code> and <code>"bar.tgz"</code>,
but not <code>"targets/foo.tgz"</code></p>
      <li data-md>
       <p>a <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern⑨">PATHPATTERN</a> of <code>"foo.tgz"</code> would match only <code>"foo.tgz"</code></p>
     </ul>
   </dl>
   <p>Prioritized delegations allow clients to resolve conflicts between delegated
roles that share responsibility for overlapping target paths.  To resolve
conflicts, clients must consider metadata in order of appearance of delegations;
we treat the order of delegations such that the first delegation is trusted
over the second one, the second delegation is trusted more than the third
one, and so on. Likewise, the metadata of the first delegation will override that
of the second delegation, the metadata of the second delegation will override
that of the third one, etc. In order to accommodate prioritized
delegations, the "roles" key in the <a data-link-type="dfn" href="#delegations" id="ref-for-delegations②">DELEGATIONS</a> object above points to an array
of delegated roles, rather than to a hash table.</p>
   <p>The metadata files for delegated target roles has the same format as the
top-level <a data-link-type="dfn" href="#targetsjson" id="ref-for-targetsjson">targets.json</a> metadata file.</p>
   <div class="example" id="example-targets.json">
    <a class="self-link" href="#example-targets.json"></a> A <a data-link-type="dfn" href="#targetsjson" id="ref-for-targetsjson①">targets.json</a> example file: 
<pre class="highlight"><c- p>{</c->
  <c- f>"signatures"</c-><c- p>:</c-> <c- p>[</c->
    <c- p>{</c->
      <c- f>"keyid"</c-><c- p>:</c-> <c- u>"135c2f50e57ff11e744d234a62cebad8c38daf399604a7655661cc9199c69164"</c-><c- p>,</c->
      <c- f>"sig"</c-><c- p>:</c-> <c- u>"e9fd40008fba263758a3ff1dc59f93e42a4910a282749af915fbbea1401178e5a0</c->
<c- u>              12090c228f06db1deb75ad8ddd7e40635ac51d4b04301fce0fd720074e0209"</c->
    <c- p>}</c->
  <c- p>],</c->
  <c- f>"signed"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"_type"</c-><c- p>:</c-> <c- u>"targets"</c-><c- p>,</c->
    <c- f>"spec_version"</c-><c- p>:</c-> <c- u>"1.0.0"</c-><c- p>,</c->
    <c- f>"delegations"</c-><c- p>:</c-> <c- p>{</c->
      <c- f>"keys"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"f761033eb880143c52358d941d987ca5577675090e2215e856ba0099bc0ce4f6"</c-><c- p>:</c-> <c- p>{</c->
          <c- f>"keytype"</c-><c- p>:</c-> <c- u>"ed25519"</c-><c- p>,</c->
          <c- f>"scheme"</c-><c- p>:</c-> <c- u>"ed25519"</c-><c- p>,</c->
          <c- f>"keyval"</c-><c- p>:</c-> <c- p>{</c->
            <c- f>"public"</c-><c- p>:</c-> <c- u>"b6e40fb71a6041212a3d84331336ecaa1f48a0c523f80ccc762a034c727606fa"</c->
          <c- p>}</c->
        <c- p>}</c->
      <c- p>},</c->
      <c- f>"roles"</c-><c- p>:</c-> <c- p>[</c->
        <c- p>{</c->
          <c- f>"keyids"</c-><c- p>:</c-> <c- p>[</c->
            <c- u>"f761033eb880143c52358d941d987ca5577675090e2215e856ba0099bc0ce4f6"</c->
          <c- p>],</c->
          <c- f>"name"</c-><c- p>:</c-> <c- u>"project"</c-><c- p>,</c->
          <c- f>"paths"</c-><c- p>:</c-> <c- p>[</c->
            <c- u>"project/file3.txt"</c->
          <c- p>],</c->
          <c- f>"threshold"</c-><c- p>:</c-> <c- mi>1</c->
        <c- p>}</c->
      <c- p>]</c->
    <c- p>},</c->
    <c- f>"expires"</c-><c- p>:</c-> <c- u>"2030-01-01T00:00:00Z"</c-><c- p>,</c->
    <c- f>"targets"</c-><c- p>:</c-> <c- p>{</c->
      <c- f>"file1.txt"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"hashes"</c-><c- p>:</c-> <c- p>{</c->
          <c- f>"sha256"</c-><c- p>:</c-> <c- u>"65b8c67f51c993d898250f40aa57a317d854900b3a04895464313e48785440da"</c->
        <c- p>},</c->
        <c- f>"length"</c-><c- p>:</c-> <c- mi>31</c->
      <c- p>},</c->
      <c- f>"dir/file2.txt"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"hashes"</c-><c- p>:</c-> <c- p>{</c->
          <c- f>"sha256"</c-><c- p>:</c-> <c- u>"452ce8308500d83ef44248d8e6062359211992fd837ea9e370e561efb1a4ca99"</c->
        <c- p>},</c->
        <c- f>"length"</c-><c- p>:</c-> <c- mi>39</c->
      <c- p>}</c->
    <c- p>},</c->
    <c- f>"version"</c-><c- p>:</c-> <c- mi>1</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="4.6" id="file-formats-timestamp"><span class="secno">4.6. </span><span class="content">File formats: timestamp.json</span><a class="self-link" href="#file-formats-timestamp"></a></h3>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="timestampjson">timestamp.json</dfn> file is signed by the timestamp role.  It indicates the latest
version of the snapshot metadata and is frequently re-signed to limit the
amount of time a client can be kept unaware of interference with obtaining
updates.</p>
   <p>Timestamp files will potentially be downloaded very frequently.  Unnecessary
information in them will be avoided.</p>
   <p>The "signed" portion of <a data-link-type="dfn" href="#timestampjson" id="ref-for-timestampjson">timestamp.json</a> is as follows:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"_type"</c-> <c- p>:</c-> <c- u>"timestamp"</c-><c- p>,</c->
  <c- f>"spec_version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#spec_version" id="ref-for-spec_version⑤">SPEC_VERSION</a><c- p>,</c->
  <c- f>"version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#role-version" id="ref-for-role-version⑤">VERSION</a><c- p>,</c->
  <c- f>"expires"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#expires" id="ref-for-expires⑤">EXPIRES</a><c- p>,</c->
  <c- f>"meta"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#metafiles" id="ref-for-metafiles②">METAFILES</a>
<c- p>}</c->
</pre>
   <p><a data-link-type="dfn" href="#spec_version" id="ref-for-spec_version⑥">SPEC_VERSION</a>, <a data-link-type="dfn" href="#role-version" id="ref-for-role-version⑥">VERSION</a> and <a data-link-type="dfn" href="#expires" id="ref-for-expires⑥">EXPIRES</a> are the same as is described for the <a data-link-type="dfn" href="#rootjson" id="ref-for-rootjson⑤">root.json</a> file.</p>
   <p><a data-link-type="dfn" href="#metafiles" id="ref-for-metafiles③">METAFILES</a> is the same as described for the <a data-link-type="dfn" href="#snapshotjson" id="ref-for-snapshotjson③">snapshot.json</a> file.  In the case
of the <a data-link-type="dfn" href="#timestampjson" id="ref-for-timestampjson①">timestamp.json</a> file, this MUST only include a description of the <a data-link-type="dfn" href="#snapshotjson" id="ref-for-snapshotjson④">snapshot.json</a> file.</p>
   <div class="example" id="example-timestamp.json">
    <a class="self-link" href="#example-timestamp.json"></a> A signed <a data-link-type="dfn" href="#timestampjson" id="ref-for-timestampjson②">timestamp.json</a> example file: 
<pre class="highlight"><c- p>{</c->
  <c- f>"signatures"</c-><c- p>:</c-> <c- p>[</c->
    <c- p>{</c->
      <c- f>"keyid"</c-><c- p>:</c-> <c- u>"1bf1c6e3cdd3d3a8420b19199e27511999850f4b376c4547b2f32fba7e80fca3"</c-><c- p>,</c->
      <c- f>"sig"</c-><c- p>:</c-> <c- u>"90d2a06c7a6c2a6a93a9f5771eb2e5ce0c93dd580bebc2080d10894623cfd6eaed</c->
<c- u>              f4df84891d5aa37ace3ae3736a698e082e12c300dfe5aee92ea33a8f461f02"</c->
    <c- p>}</c->
  <c- p>],</c->
  <c- f>"signed"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"_type"</c-><c- p>:</c-> <c- u>"timestamp"</c-><c- p>,</c->
    <c- f>"spec_version"</c-><c- p>:</c-> <c- u>"1.0.0"</c-><c- p>,</c->
    <c- f>"expires"</c-><c- p>:</c-> <c- u>"2030-01-01T00:00:00Z"</c-><c- p>,</c->
    <c- f>"meta"</c-><c- p>:</c-> <c- p>{</c->
      <c- f>"snapshot.json"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"hashes"</c-><c- p>:</c-> <c- p>{</c->
          <c- f>"sha256"</c-><c- p>:</c-> <c- u>"c14aeb4ac9f4a8fc0d83d12482b9197452f6adf3eb710e3b1e2b79e8d14cb681"</c->
        <c- p>},</c->
        <c- f>"length"</c-><c- p>:</c-> <c- mi>1007</c-><c- p>,</c->
        <c- f>"version"</c-><c- p>:</c-> <c- mi>1</c->
      <c- p>}</c->
    <c- p>},</c->
    <c- f>"version"</c-><c- p>:</c-> <c- mi>1</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="4.7" id="file-formats-mirrors"><span class="secno">4.7. </span><span class="content">File formats: mirrors.json</span><a class="self-link" href="#file-formats-mirrors"></a></h3>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="mirrorsjson">mirrors.json</dfn> file is signed by the mirrors role.  It indicates which
mirrors are active and believed to be mirroring specific parts of the
repository.</p>
   <p>The "signed" portion of <a data-link-type="dfn" href="#mirrorsjson" id="ref-for-mirrorsjson">mirrors.json</a> is as follows:</p>
<pre class="highlight"><c- p>{</c->
  <c- f>"_type"</c-> <c- p>:</c-> <c- u>"mirrors"</c-><c- p>,</c->
  <c- f>"spec_version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#spec_version" id="ref-for-spec_version⑦">SPEC_VERSION</a><c- p>,</c->
  <c- f>"version"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#role-version" id="ref-for-role-version⑦">VERSION</a><c- p>,</c->
  <c- f>"expires"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#expires" id="ref-for-expires⑦">EXPIRES</a><c- p>,</c->
  <c- f>"mirrors"</c-> <c- p>:</c-> <c- p>[</c->
    <c- p>{</c-> <c- f>"urlbase"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#urlbase" id="ref-for-urlbase">URLBASE</a><c- p>,</c->
      <c- f>"metapath"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#mirrors-metapath" id="ref-for-mirrors-metapath">METAPATH</a><c- p>,</c->
      <c- f>"targetspath"</c-> <c- p>:</c-> <a data-link-type="dfn" href="#targetspath" id="ref-for-targetspath">TARGETSPATH</a><c- p>,</c->
      <c- f>"metacontent"</c-> <c- p>:</c-> <c- p>[</c-> <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern①⓪">PATHPATTERN</a> ... <c- p>]</c-> <c- p>,</c->
      <c- f>"targetscontent"</c-> <c- p>:</c-> <c- p>[</c-> <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern①①">PATHPATTERN</a> ... <c- p>]</c-> <c- p>,</c->
      (<c- f>"custom"</c-> <c- p>:</c-> <c- p>{</c-> ... <c- p>}</c->) <c- p>}</c->
    <c- p>,</c-> ... <c- p>]</c->
<c- p>}</c->
</pre>
   <p><a data-link-type="dfn" href="#spec_version" id="ref-for-spec_version⑧">SPEC_VERSION</a>, <a data-link-type="dfn" href="#role-version" id="ref-for-role-version⑧">VERSION</a> and <a data-link-type="dfn" href="#expires" id="ref-for-expires⑧">EXPIRES</a> are the same
as is described for the <a data-link-type="dfn" href="#rootjson" id="ref-for-rootjson⑥">root.json</a> file.</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="urlbase">URLBASE</dfn>
    <dd data-md>
     <p>A string giving the URL of the mirror.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="mirrors" data-dfn-type="dfn" data-noexport id="mirrors-metapath">METAPATH</dfn>
    <dd data-md>
     <p>A string giving the location from which to retrieve metadata files. <a data-link-type="dfn" href="#mirrors-metapath" id="ref-for-mirrors-metapath①">METAPATH</a> will be a relative path to <a data-link-type="dfn" href="#urlbase" id="ref-for-urlbase①">URLBASE</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="targetspath">TARGETSPATH</dfn>
    <dd data-md>
     <p>A string giving the location from which to retrieve target files. <a data-link-type="dfn" href="#targetspath" id="ref-for-targetspath①">TARGETSPATH</a> will be a relative path to <a data-link-type="dfn" href="#urlbase" id="ref-for-urlbase②">URLBASE</a>.</p>
   </dl>
   <p>The lists of <a data-link-type="dfn" href="#pathpattern" id="ref-for-pathpattern①②">PATHPATTERN</a> for "metacontent" and "targetscontent" describe the
metadata files and target files available from the mirror.</p>
   <p>The order of the list of mirrors is important.  For any file to be
downloaded, whether it is a metadata file or a target file, the framework on
the client will give priority to the mirrors that are listed first.  That is,
the first mirror in the list whose "metacontent" or "targetscontent" include
a path that indicate the desired file can be found there will the first
mirror that will be used to download that file.  Successive mirrors with
matching paths will only be tried if downloading from earlier mirrors fails.
This behavior can be modified by the client code that uses the framework to,
for example, randomly select from the listed mirrors.</p>
   <h2 class="heading settled" data-level="5" id="detailed-client-workflow"><span class="secno">5. </span><span class="content">Detailed client workflow</span><a class="self-link" href="#detailed-client-workflow"></a></h2>
   <p class="note" role="note"><span class="marker">Note:</span> If a step in the following workflow does not succeed (e.g., the update
is aborted because a new metadata file was not signed), the client should
still be able to update again in the future. Errors raised during the update
process should not leave clients in an unrecoverable state.</p>
   <h3 class="heading settled" data-level="5.1" id="fix-time"><span class="secno">5.1. </span><span class="content">Record fixed update start time</span><a class="self-link" href="#fix-time"></a></h3>
   <p>Record the time at which the update began as the fixed update start time.
Time is fixed at the beginning of the update workflow to allow
an application using TUF to effectively pause time, in order to ensure that
metadata which has a valid expiration time at the beginning of an update
does not fail an expiration check later in the update workflow.</p>
   <h3 class="heading settled" data-level="5.2" id="load-trusted-root"><span class="secno">5.2. </span><span class="content">Load trusted root metadata</span><a class="self-link" href="#load-trusted-root"></a></h3>
   <p>Load the trusted root metadata file.  We assume that a good,
trusted copy of this file was shipped with the package manager or software
updater using an out-of-band process.  Note that the expiration of the
trusted root metadata file does not matter, because we will attempt to update
it in the next step.</p>
   <h3 class="heading settled" data-level="5.3" id="update-root"><span class="secno">5.3. </span><span class="content">Update the root role</span><a class="self-link" href="#update-root"></a></h3>
   <ol>
    <li data-md>
     <p>Since it may now be signed using entirely different keys, the client MUST
somehow be able to establish a trusted line of continuity to the latest set
of keys (see <a href="#key-management-and-migration">§ 6.1 Key management and migration</a>).  To do so, the client MUST
download intermediate root metadata files, until the latest available one is
reached.</p>
    <li data-md>
     <p>Let N denote the version number of the trusted root metadata
file.</p>
    <li data-md>
     <p><strong>Try downloading version N+1 of the root metadata file</strong>, up to
some W number of bytes (because the size is unknown). The value for W is set
by the authors of the application using TUF. For example, W may be tens of
kilobytes. The filename used to download the root metadata file is of the
fixed form VERSION_NUMBER.FILENAME.EXT (e.g., 42.root.json). If this file is
not available, or we have downloaded more than Y number of root metadata
files (because the exact number is as yet unknown), then go to step 5.3.10.
The value for Y is set by the authors of the application using TUF. For
example, Y may be 2^10.</p>
    <li data-md>
     <p><strong>Check for an arbitrary software attack.</strong> Version N+1 of the root
metadata file MUST have been signed by: (1) a threshold of keys specified in
the trusted root metadata file (version N), and (2) a threshold of keys
specified in the new root metadata file being validated (version N+1).  If
version N+1 is not signed as required, discard it, abort the update cycle,
and report the signature failure.</p>
    <li data-md>
     <p><strong>Check for a rollback attack.</strong> The version number of the new root
metadata (version N+1) MUST be exactly the version in the trusted root
metadata (version N) incremented by one, that is precisely N+1.
If the version of the new root metadata file is not N+1, discard it,
abort the update cycle, and report the rollback attack.</p>
    <li data-md>
     <p>Note that the expiration of the new (intermediate) root metadata
file does not matter yet, because we will check for it in step 5.3.10.</p>
    <li data-md>
     <p><strong>Set the trusted root metadata file</strong> to the new root metadata
file.</p>
    <li data-md>
     <p><strong>Persist root metadata.</strong> The client MUST write the file to
non-volatile storage as FILENAME.EXT (e.g. root.json).</p>
    <li data-md>
     <p>Repeat steps 5.3.2 to 5.3.9</p>
    <li data-md>
     <p><strong>Check for a freeze attack.</strong> The expiration timestamp in the
trusted root metadata file MUST be higher than the fixed update start time.
If the trusted root metadata file has expired, abort the update cycle,
report the potential freeze attack.</p>
    <li data-md>
     <p><strong>If the timestamp and / or snapshot keys have been rotated, then delete the
trusted timestamp and snapshot metadata files.</strong> This is done
in order to recover from fast-forward attacks after the repository has been
compromised and recovered. A <em>fast-forward attack</em> happens when attackers
arbitrarily increase the version numbers of: (1) the timestamp metadata, (2)
the snapshot metadata, and / or (3) the targets, or a delegated targets,
metadata file in the snapshot metadata. Please see <a href="https://theupdateframework.io/papers/prevention-rollback-attacks-atc2017.pdf">the Mercury
paper</a> for more details.</p>
    <li data-md>
     <p><strong>Set whether consistent snapshots are used as per the trusted</strong> root metadata file (see <a href="#file-formats-root">§ 4.3 File formats: root.json</a>).</p>
   </ol>
   <h3 class="heading settled" data-level="5.4" id="update-timestamp"><span class="secno">5.4. </span><span class="content">Update the timestamp role</span><a class="self-link" href="#update-timestamp"></a></h3>
   <ol>
    <li data-md>
     <p><strong>Download the timestamp metadata file</strong>, up to X number of bytes
(because the size is unknown). The value for X is set by the authors of the
application using TUF. For example, X may be tens of kilobytes. The filename
used to download the timestamp metadata file is of the fixed form FILENAME.EXT
(e.g., timestamp.json).</p>
    <li data-md>
     <p><strong>Check for an arbitrary software attack.</strong> The new timestamp
metadata file MUST have been signed by a threshold of keys specified in the
trusted root metadata file. If the new timestamp metadata file is not
properly signed, discard it, abort the update cycle, and report the signature
failure.</p>
    <li data-md>
     <p><strong>Check for a rollback attack.</strong></p>
     <ol>
      <li data-md>
       <p>The version number of the trusted timestamp metadata file, if
any, MUST be less than the version number of the new timestamp
metadata file. If the new timestamp metadata version is less than the trusted
timestamp metadata version, discard it, abort the update cycle, and
report the potential rollback attack. In case they are equal, discard the new
timestamp metadata and abort the update cycle. This is normal and it
shouldn’t raise any error. The reason for aborting the update process is that
there shouldn’t be any changes in the content of this, or any other metadata
files too, considering it has the same version as the already trusted one.</p>
      <li data-md>
       <p>The version number of the snapshot metadata file in the
trusted timestamp metadata file, if any, MUST be less than or equal to its
version number in the new timestamp metadata file. If not, discard the new
timestamp metadata file, abort the update cycle, and report the failure.</p>
     </ol>
    <li data-md>
     <p><strong>Check for a freeze attack.</strong> The expiration timestamp in the
new timestamp metadata file MUST be higher than the fixed update start time.
If so, the new timestamp metadata file becomes the trusted timestamp
metadata file.  If the new timestamp metadata file has expired, discard it,
abort the update cycle, and report the potential freeze attack.</p>
    <li data-md>
     <p><strong>Persist timestamp metadata</strong>. The client MUST write the file
to non-volatile storage as FILENAME.EXT (e.g. timestamp.json).</p>
   </ol>
   <h3 class="heading settled" data-level="5.5" id="update-snapshot"><span class="secno">5.5. </span><span class="content">Update the snapshot role</span><a class="self-link" href="#update-snapshot"></a></h3>
   <ol>
    <li data-md>
     <p><strong>Download snapshot metadata file</strong>, up to either the number of bytes
specified in the timestamp metadata file, or some Y number of bytes. The value
for Y is set by the authors of the application using TUF. For example, Y may be
tens of kilobytes. If consistent snapshots are not used (see
Section <a href="#consistent-snapshots">§ 6.2 Consistent snapshots</a>), then the filename used to download the
snapshot metadata file is of the fixed form FILENAME.EXT (e.g.,
snapshot.json).  Otherwise, the filename is of the form
VERSION_NUMBER.FILENAME.EXT (e.g., 42.snapshot.json), where VERSION_NUMBER is
the version number of the snapshot metadata file listed in the timestamp
metadata file.</p>
    <li data-md>
     <p><strong>Check against timestamp role’s snapshot hash</strong>. The hashes
of the new snapshot metadata file MUST match the hashes, if any, listed in
the trusted timestamp metadata.  This is done, in part, to prevent a
mix-and-match attack by man-in-the-middle attackers. It is safe to check the
hashes before the signatures, because the hashes come from the timestamp
role, which we have already verified in the previous step; it is also a quick
way to reject bad metadata. If the hashes do not match, discard the
new snapshot metadata, abort the update cycle, and report the failure.</p>
    <li data-md>
     <p><strong>Check for an arbitrary software attack</strong>. The new snapshot
metadata file MUST have been signed by a threshold of keys specified in the
trusted root metadata file.  If the new snapshot metadata file is not signed
as required, discard it, abort the update cycle, and report the signature
failure.</p>
    <li data-md>
     <p><strong>Check against timestamp role’s snapshot version</strong>. The version
number of the new snapshot metadata file MUST match the version number listed
in the trusted timestamp metadata.  If the versions do not match, discard the
new snapshot metadata, abort the update cycle, and report the failure.</p>
    <li data-md>
     <p><strong>Check for a rollback attack</strong>. The version number of the targets
metadata file, and all delegated targets metadata files, if any, in the
trusted snapshot metadata file, if any, MUST be less than or equal to its
version number in the new snapshot metadata file. Furthermore, any targets
metadata filename that was listed in the trusted snapshot metadata file, if
any, MUST continue to be listed in the new snapshot metadata file.  If any of
these conditions are not met, discard the new snapshot metadata file, abort
the update cycle, and report the failure.</p>
    <li data-md>
     <p><strong>Check for a freeze attack</strong>. The expiration timestamp in the
new snapshot metadata file MUST be higher than the fixed update start time.
If so, the new snapshot metadata file becomes the trusted snapshot metadata
file.  If the new snapshot metadata file is expired, discard it, abort the
update cycle, and report the potential freeze attack.</p>
    <li data-md>
     <p><strong>Persist snapshot metadata</strong>. The client MUST write the file to
non-volatile storage as FILENAME.EXT (e.g. snapshot.json).</p>
   </ol>
   <h3 class="heading settled" data-level="5.6" id="update-targets"><span class="secno">5.6. </span><span class="content">Update the targets role</span><a class="self-link" href="#update-targets"></a></h3>
   <ol>
    <li data-md>
     <p><strong>Download the top-level targets metadata file</strong>, up to either the
number of bytes specified in the snapshot metadata file, or some Z number of
bytes. The value for Z is set by the authors of the application using TUF. For
example, Z may be tens of kilobytes.  If consistent snapshots are not used (see <a href="#consistent-snapshots">§ 6.2 Consistent snapshots</a>), then the filename used to download the targets
metadata file is of the fixed form FILENAME.EXT (e.g., targets.json).
Otherwise, the filename is of the form VERSION_NUMBER.FILENAME.EXT (e.g.,
42.targets.json), where VERSION_NUMBER is the version number of the targets
metadata file listed in the snapshot metadata file.</p>
    <li data-md>
     <p><strong>Check against snapshot role’s targets hash</strong>. The hashes
of the new targets metadata file MUST match the hashes, if any, listed in the
trusted snapshot metadata.  This is done, in part, to prevent a mix-and-match
attack by man-in-the-middle attackers. It is safe to check the hashes before
the signatures, because the hashes come from the snapshot role, which we have
already verified in the previous step; it is also a quick way to reject bad
metadata. If the new targets metadata file does not match, discard the new
target metadata, abort the update cycle, and report the failure.</p>
    <li data-md>
     <p><strong>Check for an arbitrary software attack</strong>. The new targets
metadata file MUST have been signed by a threshold of keys specified in the
trusted root metadata file.  If the new targets metadata file is not signed
as required, discard it, abort the update cycle, and report the failure.</p>
    <li data-md>
     <p><strong>Check against snapshot role’s targets version</strong>. The version
number of the new targets metadata file MUST match the version number listed
in the trusted snapshot metadata.  If the versions do not match, discard it,
abort the update cycle, and report the failure.</p>
    <li data-md>
     <p><strong>Check for a freeze attack</strong>. The expiration timestamp in the
new targets metadata file MUST be higher than the fixed update start time.
If so, the new targets metadata file becomes the trusted targets metadata
file.  If the new targets metadata file is expired, discard it, abort the
update cycle, and report the potential freeze attack.</p>
    <li data-md>
     <p><strong>Persist targets metadata</strong>. The client MUST write the file to
non-volatile storage as FILENAME.EXT (e.g. targets.json).</p>
    <li data-md>
     <p><strong>Perform a pre-order depth-first search for metadata about the
desired target, beginning with the top-level targets role.</strong> Note: If
any metadata requested in steps 5.6.7.1 - 5.6.7.2 cannot be downloaded nor
validated, end the search and report that the target cannot be found.</p>
     <ol>
      <li data-md>
       <p>If this role has been visited before, then skip this role
 (so that cycles in the delegation graph are avoided).  Otherwise, if an
 application-specific maximum number of roles have been visited, then go to
 step <a href="#fetch-target">§ 5.7 Fetch target</a> (so that attackers cannot cause the client to waste excessive
 bandwidth or time).  Otherwise, if this role contains metadata about the
 desired target, then go to step <a href="#fetch-target">§ 5.7 Fetch target</a>.</p>
      <li data-md>
       <p>Otherwise, recursively search the list of delegations in
 order of appearance.</p>
       <ol>
        <li data-md>
         <p>If the current delegation is a terminating delegation,
 then jump to step <a href="#fetch-target">§ 5.7 Fetch target</a>.</p>
        <li data-md>
         <p>Otherwise, if the current delegation is a
 non-terminating delegation, continue processing the next delegation, if
 any. Stop the search, and jump to step <a href="#fetch-target">§ 5.7 Fetch target</a> as soon as a delegation
 returns a result.</p>
       </ol>
     </ol>
   </ol>
   <h3 class="heading settled" data-level="5.7" id="fetch-target"><span class="secno">5.7. </span><span class="content">Fetch target</span><a class="self-link" href="#fetch-target"></a></h3>
   <ol>
    <li data-md>
     <p><strong>Verify the desired target against its targets metadata</strong>.</p>
    <li data-md>
     <p>If there is no targets metadata about this target, abort the
  update cycle and report that there is no such target.</p>
    <li data-md>
     <p>Otherwise, download the target (up to the number of bytes
 specified in the targets metadata), and verify that its hashes match the
 targets metadata. (We download up to this number of bytes, because in some
 cases, the exact number is unknown. This may happen, for example, if an
 external program is used to compute the root hash of a tree of targets files,
 and this program does not provide the total size of all of these files.) If
 consistent snapshots are not used (see <a href="#consistent-snapshots">§ 6.2 Consistent snapshots</a>), then the
 filename used to download the target file is of the fixed form FILENAME.EXT
 (e.g., foobar.tar.gz).  Otherwise, the filename is of the form
 HASH.FILENAME.EXT (e.g.,
 c14aeb4ac9f4a8fc0d83d12482b9197452f6adf3eb710e3b1e2b79e8d14cb681.foobar.tar.gz),
 where HASH is one of the hashes of the targets file listed in the targets
 metadata file found earlier in step <a href="#update-targets">§ 5.6 Update the targets role</a>.  In either
 case, the client MUST write the file to non-volatile storage as FILENAME.EXT.</p>
   </ol>
   <h2 class="heading settled" data-level="6" id="repository-operations"><span class="secno">6. </span><span class="content">Repository operations</span><a class="self-link" href="#repository-operations"></a></h2>
   <p>See <a href="https://theupdateframework.io/">https://theupdateframework.io/</a> for
discussion of recommended usage in various situations.</p>
   <h3 class="heading settled" data-level="6.1" id="key-management-and-migration"><span class="secno">6.1. </span><span class="content">Key management and migration</span><a class="self-link" href="#key-management-and-migration"></a></h3>
   <p>All keys, except those for the timestamp and mirrors roles, should be
stored securely offline (e.g. encrypted and on a separate machine, in
special-purpose hardware, etc.).  This document does not prescribe how keys
should be encrypted and stored, and so it is left to implementers of
this document to decide how best to secure them.</p>
   <p>To replace a compromised root key or any other top-level role key, the root
role signs a new root.json file that lists the updated trusted keys for the
role.  When replacing root keys, an application will sign the new root.json
file with both the new and old root keys. Any time such a change is
required, the root.json file is versioned and accessible by version number,
e.g., 3.root.json.</p>
   <p>Clients that have outdated root keys can update to the latest set of trusted
root keys, by incrementally downloading all intermediate root metadata
files, and verifying that each current version of the root metadata is
signed by a threshold of keys specified by its immediate predecessor as well
as a threshold of keys specified by itself.
For example, if there is a 1.root.json that has threshold 2 and a
2.root.json that has threshold 3, 2.root.json MUST be signed by at least 2
keys defined in 1.root.json and at least 3 keys defined in 2.root.json. The
client starts the root key update process with the latest version of root
metadata available on the client, and stops when no version N+1 (where N is
the latest trusted version) of the root metadata is available from the
repository. This ensures that an outdated client can always correctly
re-trace the chain of trust across multiple root key updates, even if the
latest set of root keys on the client dates back multiple root metadata
versions. See step <a href="#update-root">§ 5.3 Update the root role</a> of the client application workflow for more details.</p>
   <p>Note that an attacker, who controls the repository, can launch freeze
attacks by withholding new root metadata. The attacker does not need to
compromise root keys to do so. However, these freeze attacks are limited by
the expiration time of the latest root metadata available to the client.</p>
   <p>To replace a delegated developer key, the role that delegated to that key
just replaces that key with another in the signed metadata where the
delegation is done.</p>
   <h3 class="heading settled" data-level="6.2" id="consistent-snapshots"><span class="secno">6.2. </span><span class="content">Consistent snapshots</span><a class="self-link" href="#consistent-snapshots"></a></h3>
   <p>So far, we have considered a TUF repository that is relatively static (in
terms of how often metadata and target files are updated). The problem is
that if the repository (which may be a community repository such as PyPI,
RubyGems, CPAN, or SourceForge) is volatile, in the sense that the
repository is continually producing new TUF metadata as well as its targets,
then should clients read metadata while the same metadata is being written
to, they would effectively see denial-of-service attacks.  Therefore, the
repository needs to be careful about how it writes metadata and targets. The
high-level idea of the solution is that each snapshot will be contained in a
so-called consistent snapshot. If a client is reading from one consistent
snapshot, then the repository is free to write another consistent snapshot
without interrupting that client.</p>
   <h4 class="heading settled" data-level="6.2.1" id="writing-consistent-snapshots"><span class="secno">6.2.1. </span><span class="content">Writing consistent snapshots</span><a class="self-link" href="#writing-consistent-snapshots"></a></h4>
   <p>We now explain how a repository should write metadata and targets to
produce self-contained consistent snapshots.</p>
   <p>Simply put, every metadata file MUST be named as such: if the
file had the original name of FILENAME.EXT, then it MUST be written to
non-volatile storage as VERSION_NUMBER.FILENAME.EXT, where VERSION_NUMBER
is the integer version number listed in the metadata file.</p>
   <p>On the other hand, consistent target files MUST be written to
non-volatile storage as HASH.FILENAME.EXT.  This means that if the
referrer metadata lists N cryptographic hashes of the referred file, then
there MUST be N identical copies of the referred file, where each file will
be distinguished only by the value of the digest in its filename. The
modified filename need not include the name of the cryptographic hash
function used to produce the digest because, on a read, the choice of
function follows from the selection of a digest (which includes the name of
the cryptographic function) from all digests in the referred file.</p>
   <p>Timestamp metadata (timestamp.EXT) MUST be written to non-volatile storage
without a version prefix whenever it is updated. This is required because
timestamp metadata is the only metadata file that may be requested without known
version numbers.  It is OPTIONAL for an implementation to write an identical copy
of timestamp.EXT to the respective VERSION_NUMBER.timestamp.EXT for
record-keeping purposes.</p>
   <p>Most importantly, metadata file formats SHALL NOT be updated to refer to the
names of metadata or target files with their consistent snapshot prefix
included. In other words, if a metadata file A refers to another metadata file B
as FILENAME.EXT, then the filename listed in the metadata MUST remain as
FILENAME.EXT and not VERSION_NUMBER.FILENAME.EXT. This rule is in place so that
metadata signed by roles with offline keys will not be forced to sign for the
metadata file whenever it is updated. In the next subsection, we will see how
clients will reproduce the name of the intended file.</p>
   <p>Finally, when consistent snapshots are written by the repository the root
metadata MUST write the boolean <a data-link-type="dfn" href="#consistent_snapshot" id="ref-for-consistent_snapshot②">CONSISTENT_SNAPSHOT</a> attribute at the root
level of its keys of attributes set to the true value. If consistent snapshots
are not written by the repository, then the attribute MAY either be left
unspecified or be set to the false value.</p>
   <p>Regardless of whether consistent snapshots are ever used or not, all
released versions of root metadata files MUST always be provided
so that outdated clients can update to the latest available root.</p>
   <h4 class="heading settled" data-level="6.2.2" id="reading-consistent-snapshots"><span class="secno">6.2.2. </span><span class="content">Reading consistent snapshots</span><a class="self-link" href="#reading-consistent-snapshots"></a></h4>
   <p>See <a href="#detailed-client-workflow">§ 5 Detailed client workflow</a> for more details.</p>
   <h3 class="heading settled" data-level="6.3" id="adding-updating-targets"><span class="secno">6.3. </span><span class="content">Adding and updating targets</span><a class="self-link" href="#adding-updating-targets"></a></h3>
   <p>The following subsections describe how to update metadata on the repository
when adding targets to the repository, or updating existing targets.</p>
   <h4 class="heading settled" data-level="6.3.1" id="update-targets-metadata"><span class="secno">6.3.1. </span><span class="content">Update targets metadata</span><a class="self-link" href="#update-targets-metadata"></a></h4>
   <ol>
    <li data-md>
     <p>Add the new (or update an existing) <a data-link-type="dfn" href="#targets-obj-targets" id="ref-for-targets-obj-targets④">TARGETS</a> object
 in the relevant targets metadata (either the top-level targets metadata, or
 a delegated targets metadata).</p>
    <li data-md>
     <p>Increment the <a data-link-type="dfn" href="#role-version" id="ref-for-role-version⑨">VERSION</a> number in the updated targets
 metadata.</p>
    <li data-md>
     <p>Sign the updated targets metadata with at least a <a data-link-type="dfn" href="#threshold" id="ref-for-threshold②">THRESHOLD</a> of keys
 for the associated targets role (either the top-level targets role, or a
 delegated targets role).</p>
    <li data-md>
     <p>Write the updated targets metadata, ensuring the targets metadata filename is
 prefixed with the <a data-link-type="dfn" href="#role-version" id="ref-for-role-version①⓪">VERSION</a> number if consistent snapshots
 are enabled for the repository.</p>
   </ol>
   <h4 class="heading settled" data-level="6.3.2" id="update-snapshot-metadata"><span class="secno">6.3.2. </span><span class="content">Update snapshot metadata</span><a class="self-link" href="#update-snapshot-metadata"></a></h4>
   <ol>
    <li data-md>
     <p>Update the <a data-link-type="dfn" href="#metapath-version" id="ref-for-metapath-version②">VERSION</a> number and, when in use, <a data-link-type="dfn" href="#metapath-length" id="ref-for-metapath-length①">LENGTH</a> and <a data-link-type="dfn" href="#metapath-hashes" id="ref-for-metapath-hashes②">HASHES</a> for any targets
 metadata modified during <a href="#update-targets-metadata">§ 6.3.1 Update targets metadata</a> within the <a data-link-type="dfn" href="#metafiles" id="ref-for-metafiles④">METAFILES</a> object of the snapshot metadata.</p>
    <li data-md>
     <p>Increment the <a data-link-type="dfn" href="#role-version" id="ref-for-role-version①①">VERSION</a> number of the snapshot metadata.</p>
    <li data-md>
     <p>Sign the snapshot metadata with at least a <a data-link-type="dfn" href="#threshold" id="ref-for-threshold③">THRESHOLD</a> of keys for the
 snapshot role.</p>
    <li data-md>
     <p>Write the updated snapshot metadata, ensuring the snapshot metadata filename
 is prefixed with the <a data-link-type="dfn" href="#role-version" id="ref-for-role-version①②">VERSION</a> number if consistent
 snapshots are enabled for the repository.</p>
   </ol>
   <h4 class="heading settled" data-level="6.3.3" id="update-timestamp-metadata"><span class="secno">6.3.3. </span><span class="content">Update timestamp metadata</span><a class="self-link" href="#update-timestamp-metadata"></a></h4>
   <ol>
    <li data-md>
     <p>Update the <a data-link-type="dfn" href="#metapath-version" id="ref-for-metapath-version③">VERSION</a> and, when in use, the <a data-link-type="dfn" href="#metapath-length" id="ref-for-metapath-length②">LENGTH</a> and <a data-link-type="dfn" href="#metapath-hashes" id="ref-for-metapath-hashes③">HASHES</a> for the
 snapshot metadata within the <a data-link-type="dfn" href="#metafiles" id="ref-for-metafiles⑤">METAFILES</a> object of the timestamp
 metadata.</p>
    <li data-md>
     <p>Increment the <a data-link-type="dfn" href="#role-version" id="ref-for-role-version①③">VERSION</a> number of the timestamp metadata.</p>
    <li data-md>
     <p>Sign the timestamp metadata with at least a <a data-link-type="dfn" href="#threshold" id="ref-for-threshold④">THRESHOLD</a> of keys for the
 timestamp role.</p>
    <li data-md>
     <p>Write the updated timestamp metadata, ensuring the timestamp metadata
 filename is prefixed with the <a data-link-type="dfn" href="#role-version" id="ref-for-role-version①④">VERSION</a> number if consistent
 snapshots are enabled for the repository.</p>
   </ol>
   <h2 class="heading settled" data-level="7" id="future-directions-and-open-questions"><span class="secno">7. </span><span class="content">Future directions and open questions</span><a class="self-link" href="#future-directions-and-open-questions"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="support-for-bogus-clocks"><span class="secno">7.1. </span><span class="content">Support for bogus clocks</span><a class="self-link" href="#support-for-bogus-clocks"></a></h3>
   <p>The framework may need to offer an application-enablable "no, my clock is <em>supposed</em> to be wrong" mode, since others have noticed that many users seem
to have incorrect clocks.</p>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#consistent_snapshot">CONSISTENT_SNAPSHOT</a><span>, in § 4.3</span>
   <li><a href="#custom">CUSTOM</a><span>, in § 4.5</span>
   <li><a href="#date-time">date-time</a><span>, in § 4.2.3</span>
   <li><a href="#delegations">DELEGATIONS</a><span>, in § 4.5</span>
   <li><a href="#keytype-ecdsa">"ecdsa"</a><span>, in § 4.2.2</span>
   <li><a href="#scheme-ecdsa-sha2-nistp256">"ecdsa-sha2-nistp256"</a><span>, in § 4.2.2</span>
   <li>
    "ed25519"
    <ul>
     <li><a href="#keytype-ed25519">dfn for keytype</a><span>, in § 4.2.2</span>
     <li><a href="#scheme-ed25519">dfn for scheme</a><span>, in § 4.2.2</span>
    </ul>
   <li><a href="#expires">EXPIRES</a><span>, in § 4.3</span>
   <li><a href="#hash">HASH</a><span>, in § 4.4</span>
   <li>
    HASHES
    <ul>
     <li><a href="#metapath-hashes">dfn for metapath</a><span>, in § 4.4</span>
     <li><a href="#targets-obj-hashes">dfn for targets-obj</a><span>, in § 4.5</span>
    </ul>
   <li><a href="#hex_digest">HEX_DIGEST</a><span>, in § 4.5</span>
   <li><a href="#key">KEY</a><span>, in § 4.2.2</span>
   <li>
    KEYID
    <ul>
     <li><a href="#role-keyid">dfn for role</a><span>, in § 4.2.1</span>
     <li><a href="#root-keyid">dfn for root</a><span>, in § 4.3</span>
    </ul>
   <li><a href="#keytype">KEYTYPE</a><span>, in § 4.2.2</span>
   <li><a href="#keyval">KEYVAL</a><span>, in § 4.2.2</span>
   <li>
    LENGTH
    <ul>
     <li><a href="#metapath-length">dfn for metapath</a><span>, in § 4.4</span>
     <li><a href="#targets-obj-length">dfn for targets-obj</a><span>, in § 4.5</span>
    </ul>
   <li><a href="#metafiles">METAFILES</a><span>, in § 4.4</span>
   <li>
    METAPATH
    <ul>
     <li><a href="#mirrors-metapath">dfn for mirrors</a><span>, in § 4.7</span>
     <li><a href="#snapshot-metapath">dfn for snapshot</a><span>, in § 4.4</span>
    </ul>
   <li><a href="#mirrorsjson">mirrors.json</a><span>, in § 4.7</span>
   <li><a href="#path_hash_prefixes">"path_hash_prefixes"</a><span>, in § 4.5</span>
   <li><a href="#pathpattern">PATHPATTERN</a><span>, in § 4.5</span>
   <li><a href="#delegation-role-paths">"paths"</a><span>, in § 4.5</span>
   <li>
    PUBLIC
    <ul>
     <li><a href="#keyval-ecdsa-public">dfn for keyval-ecdsa</a><span>, in § 4.2.2</span>
     <li><a href="#keyval-ed25519-public">dfn for keyval-ed25519</a><span>, in § 4.2.2</span>
     <li><a href="#keyval-rsa-public">dfn for keyval-rsa</a><span>, in § 4.2.2</span>
    </ul>
   <li>
    ROLE
    <ul>
     <li><a href="#role-role">dfn for role</a><span>, in § 4.2.1</span>
     <li><a href="#root-role">dfn for root</a><span>, in § 4.3</span>
    </ul>
   <li><a href="#rolename">ROLENAME</a><span>, in § 4.5</span>
   <li><a href="#rootjson">root.json</a><span>, in § 4.3</span>
   <li><a href="#keytype-rsa">"rsa"</a><span>, in § 4.2.2</span>
   <li><a href="#scheme-rsassa-pss-sha256">"rsassa-pss-sha256"</a><span>, in § 4.2.2</span>
   <li><a href="#scheme">SCHEME</a><span>, in § 4.2.2</span>
   <li><a href="#signature">SIGNATURE</a><span>, in § 4.2.1</span>
   <li><a href="#snapshotjson">snapshot.json</a><span>, in § 4.4</span>
   <li><a href="#spec_version">SPEC_VERSION</a><span>, in § 4.3</span>
   <li><a href="#targetpath">TARGETPATH</a><span>, in § 4.5</span>
   <li><a href="#targets-obj-targets">TARGETS</a><span>, in § 4.5</span>
   <li><a href="#targetsjson">targets.json</a><span>, in § 4.5</span>
   <li><a href="#targetspath">TARGETSPATH</a><span>, in § 4.7</span>
   <li><a href="#terminating">TERMINATING</a><span>, in § 4.5</span>
   <li><a href="#threshold">THRESHOLD</a><span>, in § 4.3</span>
   <li><a href="#timestampjson">timestamp.json</a><span>, in § 4.6</span>
   <li><a href="#urlbase">URLBASE</a><span>, in § 4.7</span>
   <li>
    VERSION
    <ul>
     <li><a href="#metapath-version">dfn for metapath</a><span>, in § 4.4</span>
     <li><a href="#role-version">dfn for role</a><span>, in § 4.3</span>
    </ul>
  </ul>
<script>/* script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* script-dfn-panel-json */
window.dfnpanelData = {};
window.dfnpanelData['role-role'] = {"dfnID": "role-role", "url": "#role-role", "dfnText": "ROLE", "refSections": [{"refs": [{"id": "ref-for-role-role"}, {"id": "ref-for-role-role\u2460"}, {"id": "ref-for-role-role\u2461"}], "title": "4.2.1. Object format"}], "external": false};
window.dfnpanelData['role-keyid'] = {"dfnID": "role-keyid", "url": "#role-keyid", "dfnText": "KEYID", "refSections": [{"refs": [{"id": "ref-for-role-keyid"}], "title": "4.2.1. Object format"}, {"refs": [{"id": "ref-for-role-keyid\u2460"}, {"id": "ref-for-role-keyid\u2461"}, {"id": "ref-for-role-keyid\u2462"}, {"id": "ref-for-role-keyid\u2463"}], "title": "4.3. File formats: root.json"}, {"refs": [{"id": "ref-for-role-keyid\u2464"}, {"id": "ref-for-role-keyid\u2465"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['signature'] = {"dfnID": "signature", "url": "#signature", "dfnText": "SIGNATURE", "refSections": [{"refs": [{"id": "ref-for-signature"}], "title": "4.2.1. Object format"}], "external": false};
window.dfnpanelData['key'] = {"dfnID": "key", "url": "#key", "dfnText": "KEY", "refSections": [{"refs": [{"id": "ref-for-key"}], "title": "4.3. File formats: root.json"}, {"refs": [{"id": "ref-for-key\u2460"}, {"id": "ref-for-key\u2461"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['keytype'] = {"dfnID": "keytype", "url": "#keytype", "dfnText": "KEYTYPE", "refSections": [{"refs": [{"id": "ref-for-keytype"}, {"id": "ref-for-keytype\u2460"}, {"id": "ref-for-keytype\u2461"}, {"id": "ref-for-keytype\u2462"}, {"id": "ref-for-keytype\u2463"}, {"id": "ref-for-keytype\u2464"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['scheme'] = {"dfnID": "scheme", "url": "#scheme", "dfnText": "SCHEME", "refSections": [{"refs": [{"id": "ref-for-scheme"}, {"id": "ref-for-scheme\u2460"}, {"id": "ref-for-scheme\u2461"}, {"id": "ref-for-scheme\u2462"}, {"id": "ref-for-scheme\u2463"}, {"id": "ref-for-scheme\u2464"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['keyval'] = {"dfnID": "keyval", "url": "#keyval", "dfnText": "KEYVAL", "refSections": [{"refs": [{"id": "ref-for-keyval"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['scheme-rsassa-pss-sha256'] = {"dfnID": "scheme-rsassa-pss-sha256", "url": "#scheme-rsassa-pss-sha256", "dfnText": "\"rsassa-pss-sha256\"", "refSections": [{"refs": [{"id": "ref-for-scheme-rsassa-pss-sha256"}, {"id": "ref-for-scheme-rsassa-pss-sha256\u2460"}, {"id": "ref-for-scheme-rsassa-pss-sha256\u2461"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['scheme-ed25519'] = {"dfnID": "scheme-ed25519", "url": "#scheme-ed25519", "dfnText": "\"ed25519\"", "refSections": [{"refs": [{"id": "ref-for-scheme-ed25519"}, {"id": "ref-for-scheme-ed25519\u2460"}, {"id": "ref-for-scheme-ed25519\u2461"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['scheme-ecdsa-sha2-nistp256'] = {"dfnID": "scheme-ecdsa-sha2-nistp256", "url": "#scheme-ecdsa-sha2-nistp256", "dfnText": "\"ecdsa-sha2-nistp256\"", "refSections": [{"refs": [{"id": "ref-for-scheme-ecdsa-sha2-nistp256"}, {"id": "ref-for-scheme-ecdsa-sha2-nistp256\u2460"}, {"id": "ref-for-scheme-ecdsa-sha2-nistp256\u2461"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['keytype-rsa'] = {"dfnID": "keytype-rsa", "url": "#keytype-rsa", "dfnText": "\"rsa\"", "refSections": [{"refs": [{"id": "ref-for-keytype-rsa"}, {"id": "ref-for-keytype-rsa\u2460"}, {"id": "ref-for-keytype-rsa\u2461"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['keyval-rsa-public'] = {"dfnID": "keyval-rsa-public", "url": "#keyval-rsa-public", "dfnText": "PUBLIC", "refSections": [{"refs": [{"id": "ref-for-keyval-rsa-public"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['keytype-ed25519'] = {"dfnID": "keytype-ed25519", "url": "#keytype-ed25519", "dfnText": "\"ed25519\"", "refSections": [{"refs": [{"id": "ref-for-keytype-ed25519"}, {"id": "ref-for-keytype-ed25519\u2460"}, {"id": "ref-for-keytype-ed25519\u2461"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['keyval-ed25519-public'] = {"dfnID": "keyval-ed25519-public", "url": "#keyval-ed25519-public", "dfnText": "PUBLIC", "refSections": [{"refs": [{"id": "ref-for-keyval-ed25519-public"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['keytype-ecdsa'] = {"dfnID": "keytype-ecdsa", "url": "#keytype-ecdsa", "dfnText": "\"ecdsa\"", "refSections": [{"refs": [{"id": "ref-for-keytype-ecdsa"}, {"id": "ref-for-keytype-ecdsa\u2460"}, {"id": "ref-for-keytype-ecdsa\u2461"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['keyval-ecdsa-public'] = {"dfnID": "keyval-ecdsa-public", "url": "#keyval-ecdsa-public", "dfnText": "PUBLIC", "refSections": [{"refs": [{"id": "ref-for-keyval-ecdsa-public"}], "title": "4.2.2. Key objects"}], "external": false};
window.dfnpanelData['date-time'] = {"dfnID": "date-time", "url": "#date-time", "dfnText": "date-time", "refSections": [{"refs": [{"id": "ref-for-date-time"}], "title": "4.2.3. Date-time"}, {"refs": [{"id": "ref-for-date-time\u2460"}], "title": "4.3. File formats: root.json"}], "external": false};
window.dfnpanelData['rootjson'] = {"dfnID": "rootjson", "url": "#rootjson", "dfnText": "root.json", "refSections": [{"refs": [{"id": "ref-for-rootjson"}, {"id": "ref-for-rootjson\u2460"}], "title": "4.3. File formats: root.json"}, {"refs": [{"id": "ref-for-rootjson\u2461"}], "title": "4.4. File formats: snapshot.json"}, {"refs": [{"id": "ref-for-rootjson\u2462"}, {"id": "ref-for-rootjson\u2463"}], "title": "4.5. File formats: targets.json and delegated target roles"}, {"refs": [{"id": "ref-for-rootjson\u2464"}], "title": "4.6. File formats: timestamp.json"}, {"refs": [{"id": "ref-for-rootjson\u2465"}], "title": "4.7. File formats: mirrors.json"}], "external": false};
window.dfnpanelData['spec_version'] = {"dfnID": "spec_version", "url": "#spec_version", "dfnText": "SPEC_VERSION", "refSections": [{"refs": [{"id": "ref-for-spec_version"}], "title": "4.3. File formats: root.json"}, {"refs": [{"id": "ref-for-spec_version\u2460"}, {"id": "ref-for-spec_version\u2461"}], "title": "4.4. File formats: snapshot.json"}, {"refs": [{"id": "ref-for-spec_version\u2462"}, {"id": "ref-for-spec_version\u2463"}], "title": "4.5. File formats: targets.json and delegated target roles"}, {"refs": [{"id": "ref-for-spec_version\u2464"}, {"id": "ref-for-spec_version\u2465"}], "title": "4.6. File formats: timestamp.json"}, {"refs": [{"id": "ref-for-spec_version\u2466"}, {"id": "ref-for-spec_version\u2467"}], "title": "4.7. File formats: mirrors.json"}], "external": false};
window.dfnpanelData['consistent_snapshot'] = {"dfnID": "consistent_snapshot", "url": "#consistent_snapshot", "dfnText": "CONSISTENT_SNAPSHOT", "refSections": [{"refs": [{"id": "ref-for-consistent_snapshot"}], "title": "3.1.1. Target files"}, {"refs": [{"id": "ref-for-consistent_snapshot\u2460"}], "title": "4.3. File formats: root.json"}, {"refs": [{"id": "ref-for-consistent_snapshot\u2461"}], "title": "6.2.1. Writing consistent snapshots"}], "external": false};
window.dfnpanelData['role-version'] = {"dfnID": "role-version", "url": "#role-version", "dfnText": "VERSION", "refSections": [{"refs": [{"id": "ref-for-role-version"}], "title": "4.3. File formats: root.json"}, {"refs": [{"id": "ref-for-role-version\u2460"}, {"id": "ref-for-role-version\u2461"}], "title": "4.4. File formats: snapshot.json"}, {"refs": [{"id": "ref-for-role-version\u2462"}, {"id": "ref-for-role-version\u2463"}], "title": "4.5. File formats: targets.json and delegated target roles"}, {"refs": [{"id": "ref-for-role-version\u2464"}, {"id": "ref-for-role-version\u2465"}], "title": "4.6. File formats: timestamp.json"}, {"refs": [{"id": "ref-for-role-version\u2466"}, {"id": "ref-for-role-version\u2467"}], "title": "4.7. File formats: mirrors.json"}, {"refs": [{"id": "ref-for-role-version\u2468"}, {"id": "ref-for-role-version\u2460\u24ea"}], "title": "6.3.1. Update targets metadata"}, {"refs": [{"id": "ref-for-role-version\u2460\u2460"}, {"id": "ref-for-role-version\u2460\u2461"}], "title": "6.3.2. Update snapshot metadata"}, {"refs": [{"id": "ref-for-role-version\u2460\u2462"}, {"id": "ref-for-role-version\u2460\u2463"}], "title": "6.3.3. Update timestamp metadata"}], "external": false};
window.dfnpanelData['expires'] = {"dfnID": "expires", "url": "#expires", "dfnText": "EXPIRES", "refSections": [{"refs": [{"id": "ref-for-expires"}], "title": "4.3. File formats: root.json"}, {"refs": [{"id": "ref-for-expires\u2460"}, {"id": "ref-for-expires\u2461"}], "title": "4.4. File formats: snapshot.json"}, {"refs": [{"id": "ref-for-expires\u2462"}, {"id": "ref-for-expires\u2463"}], "title": "4.5. File formats: targets.json and delegated target roles"}, {"refs": [{"id": "ref-for-expires\u2464"}, {"id": "ref-for-expires\u2465"}], "title": "4.6. File formats: timestamp.json"}, {"refs": [{"id": "ref-for-expires\u2466"}, {"id": "ref-for-expires\u2467"}], "title": "4.7. File formats: mirrors.json"}], "external": false};
window.dfnpanelData['root-role'] = {"dfnID": "root-role", "url": "#root-role", "dfnText": "ROLE", "refSections": [{"refs": [{"id": "ref-for-root-role"}], "title": "4.3. File formats: root.json"}], "external": false};
window.dfnpanelData['root-keyid'] = {"dfnID": "root-keyid", "url": "#root-keyid", "dfnText": "KEYID", "refSections": [{"refs": [{"id": "ref-for-root-keyid"}, {"id": "ref-for-root-keyid\u2460"}], "title": "4.3. File formats: root.json"}, {"refs": [{"id": "ref-for-root-keyid\u2461"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['threshold'] = {"dfnID": "threshold", "url": "#threshold", "dfnText": "THRESHOLD", "refSections": [{"refs": [{"id": "ref-for-threshold"}], "title": "4.3. File formats: root.json"}, {"refs": [{"id": "ref-for-threshold\u2460"}], "title": "4.5. File formats: targets.json and delegated target roles"}, {"refs": [{"id": "ref-for-threshold\u2461"}], "title": "6.3.1. Update targets metadata"}, {"refs": [{"id": "ref-for-threshold\u2462"}], "title": "6.3.2. Update snapshot metadata"}, {"refs": [{"id": "ref-for-threshold\u2463"}], "title": "6.3.3. Update timestamp metadata"}], "external": false};
window.dfnpanelData['snapshotjson'] = {"dfnID": "snapshotjson", "url": "#snapshotjson", "dfnText": "snapshot.json", "refSections": [{"refs": [{"id": "ref-for-snapshotjson"}, {"id": "ref-for-snapshotjson\u2460"}, {"id": "ref-for-snapshotjson\u2461"}], "title": "4.4. File formats: snapshot.json"}, {"refs": [{"id": "ref-for-snapshotjson\u2462"}, {"id": "ref-for-snapshotjson\u2463"}], "title": "4.6. File formats: timestamp.json"}], "external": false};
window.dfnpanelData['metafiles'] = {"dfnID": "metafiles", "url": "#metafiles", "dfnText": "METAFILES", "refSections": [{"refs": [{"id": "ref-for-metafiles"}], "title": "4.4. File formats: snapshot.json"}, {"refs": [{"id": "ref-for-metafiles\u2460"}], "title": "4.5. File formats: targets.json and delegated target roles"}, {"refs": [{"id": "ref-for-metafiles\u2461"}, {"id": "ref-for-metafiles\u2462"}], "title": "4.6. File formats: timestamp.json"}, {"refs": [{"id": "ref-for-metafiles\u2463"}], "title": "6.3.2. Update snapshot metadata"}, {"refs": [{"id": "ref-for-metafiles\u2464"}], "title": "6.3.3. Update timestamp metadata"}], "external": false};
window.dfnpanelData['snapshot-metapath'] = {"dfnID": "snapshot-metapath", "url": "#snapshot-metapath", "dfnText": "METAPATH", "refSections": [{"refs": [{"id": "ref-for-snapshot-metapath"}, {"id": "ref-for-snapshot-metapath\u2460"}, {"id": "ref-for-snapshot-metapath\u2461"}, {"id": "ref-for-snapshot-metapath\u2462"}, {"id": "ref-for-snapshot-metapath\u2463"}, {"id": "ref-for-snapshot-metapath\u2464"}], "title": "4.4. File formats: snapshot.json"}], "external": false};
window.dfnpanelData['metapath-version'] = {"dfnID": "metapath-version", "url": "#metapath-version", "dfnText": "VERSION", "refSections": [{"refs": [{"id": "ref-for-metapath-version"}, {"id": "ref-for-metapath-version\u2460"}], "title": "4.4. File formats: snapshot.json"}, {"refs": [{"id": "ref-for-metapath-version\u2461"}], "title": "6.3.2. Update snapshot metadata"}, {"refs": [{"id": "ref-for-metapath-version\u2462"}], "title": "6.3.3. Update timestamp metadata"}], "external": false};
window.dfnpanelData['metapath-length'] = {"dfnID": "metapath-length", "url": "#metapath-length", "dfnText": "LENGTH", "refSections": [{"refs": [{"id": "ref-for-metapath-length"}], "title": "4.4. File formats: snapshot.json"}, {"refs": [{"id": "ref-for-metapath-length\u2460"}], "title": "6.3.2. Update snapshot metadata"}, {"refs": [{"id": "ref-for-metapath-length\u2461"}], "title": "6.3.3. Update timestamp metadata"}], "external": false};
window.dfnpanelData['metapath-hashes'] = {"dfnID": "metapath-hashes", "url": "#metapath-hashes", "dfnText": "HASHES", "refSections": [{"refs": [{"id": "ref-for-metapath-hashes"}, {"id": "ref-for-metapath-hashes\u2460"}], "title": "4.4. File formats: snapshot.json"}, {"refs": [{"id": "ref-for-metapath-hashes\u2461"}], "title": "6.3.2. Update snapshot metadata"}, {"refs": [{"id": "ref-for-metapath-hashes\u2462"}], "title": "6.3.3. Update timestamp metadata"}], "external": false};
window.dfnpanelData['hash'] = {"dfnID": "hash", "url": "#hash", "dfnText": "HASH", "refSections": [{"refs": [{"id": "ref-for-hash"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['targetsjson'] = {"dfnID": "targetsjson", "url": "#targetsjson", "dfnText": "targets.json", "refSections": [{"refs": [{"id": "ref-for-targetsjson"}, {"id": "ref-for-targetsjson\u2460"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['targets-obj-targets'] = {"dfnID": "targets-obj-targets", "url": "#targets-obj-targets", "dfnText": "TARGETS", "refSections": [{"refs": [{"id": "ref-for-targets-obj-targets"}, {"id": "ref-for-targets-obj-targets\u2460"}, {"id": "ref-for-targets-obj-targets\u2461"}, {"id": "ref-for-targets-obj-targets\u2462"}], "title": "4.5. File formats: targets.json and delegated target roles"}, {"refs": [{"id": "ref-for-targets-obj-targets\u2463"}], "title": "6.3.1. Update targets metadata"}], "external": false};
window.dfnpanelData['targetpath'] = {"dfnID": "targetpath", "url": "#targetpath", "dfnText": "TARGETPATH", "refSections": [{"refs": [{"id": "ref-for-targetpath"}, {"id": "ref-for-targetpath\u2460"}, {"id": "ref-for-targetpath\u2461"}, {"id": "ref-for-targetpath\u2462"}, {"id": "ref-for-targetpath\u2463"}, {"id": "ref-for-targetpath\u2464"}, {"id": "ref-for-targetpath\u2465"}, {"id": "ref-for-targetpath\u2466"}, {"id": "ref-for-targetpath\u2467"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['targets-obj-length'] = {"dfnID": "targets-obj-length", "url": "#targets-obj-length", "dfnText": "LENGTH", "refSections": [{"refs": [{"id": "ref-for-targets-obj-length"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['targets-obj-hashes'] = {"dfnID": "targets-obj-hashes", "url": "#targets-obj-hashes", "dfnText": "HASHES", "refSections": [{"refs": [{"id": "ref-for-targets-obj-hashes"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['custom'] = {"dfnID": "custom", "url": "#custom", "dfnText": "CUSTOM", "refSections": [{"refs": [{"id": "ref-for-custom"}, {"id": "ref-for-custom\u2460"}, {"id": "ref-for-custom\u2461"}, {"id": "ref-for-custom\u2462"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['delegations'] = {"dfnID": "delegations", "url": "#delegations", "dfnText": "DELEGATIONS", "refSections": [{"refs": [{"id": "ref-for-delegations"}, {"id": "ref-for-delegations\u2460"}, {"id": "ref-for-delegations\u2461"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['rolename'] = {"dfnID": "rolename", "url": "#rolename", "dfnText": "ROLENAME", "refSections": [{"refs": [{"id": "ref-for-rolename"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['terminating'] = {"dfnID": "terminating", "url": "#terminating", "dfnText": "TERMINATING", "refSections": [{"refs": [{"id": "ref-for-terminating"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['path_hash_prefixes'] = {"dfnID": "path_hash_prefixes", "url": "#path_hash_prefixes", "dfnText": "\"path_hash_prefixes\"", "refSections": [{"refs": [{"id": "ref-for-path_hash_prefixes"}, {"id": "ref-for-path_hash_prefixes\u2460"}, {"id": "ref-for-path_hash_prefixes\u2461"}, {"id": "ref-for-path_hash_prefixes\u2462"}, {"id": "ref-for-path_hash_prefixes\u2463"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['hex_digest'] = {"dfnID": "hex_digest", "url": "#hex_digest", "dfnText": "HEX_DIGEST", "refSections": [{"refs": [{"id": "ref-for-hex_digest"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['delegation-role-paths'] = {"dfnID": "delegation-role-paths", "url": "#delegation-role-paths", "dfnText": "\"paths\"", "refSections": [{"refs": [{"id": "ref-for-delegation-role-paths"}, {"id": "ref-for-delegation-role-paths\u2460"}], "title": "4.5. File formats: targets.json and delegated target roles"}], "external": false};
window.dfnpanelData['pathpattern'] = {"dfnID": "pathpattern", "url": "#pathpattern", "dfnText": "PATHPATTERN", "refSections": [{"refs": [{"id": "ref-for-pathpattern"}, {"id": "ref-for-pathpattern\u2460"}, {"id": "ref-for-pathpattern\u2461"}, {"id": "ref-for-pathpattern\u2462"}, {"id": "ref-for-pathpattern\u2463"}, {"id": "ref-for-pathpattern\u2464"}, {"id": "ref-for-pathpattern\u2465"}, {"id": "ref-for-pathpattern\u2466"}, {"id": "ref-for-pathpattern\u2467"}, {"id": "ref-for-pathpattern\u2468"}], "title": "4.5. File formats: targets.json and delegated target roles"}, {"refs": [{"id": "ref-for-pathpattern\u2460\u24ea"}, {"id": "ref-for-pathpattern\u2460\u2460"}, {"id": "ref-for-pathpattern\u2460\u2461"}], "title": "4.7. File formats: mirrors.json"}], "external": false};
window.dfnpanelData['timestampjson'] = {"dfnID": "timestampjson", "url": "#timestampjson", "dfnText": "timestamp.json", "refSections": [{"refs": [{"id": "ref-for-timestampjson"}, {"id": "ref-for-timestampjson\u2460"}, {"id": "ref-for-timestampjson\u2461"}], "title": "4.6. File formats: timestamp.json"}], "external": false};
window.dfnpanelData['mirrorsjson'] = {"dfnID": "mirrorsjson", "url": "#mirrorsjson", "dfnText": "mirrors.json", "refSections": [{"refs": [{"id": "ref-for-mirrorsjson"}], "title": "4.7. File formats: mirrors.json"}], "external": false};
window.dfnpanelData['urlbase'] = {"dfnID": "urlbase", "url": "#urlbase", "dfnText": "URLBASE", "refSections": [{"refs": [{"id": "ref-for-urlbase"}, {"id": "ref-for-urlbase\u2460"}, {"id": "ref-for-urlbase\u2461"}], "title": "4.7. File formats: mirrors.json"}], "external": false};
window.dfnpanelData['mirrors-metapath'] = {"dfnID": "mirrors-metapath", "url": "#mirrors-metapath", "dfnText": "METAPATH", "refSections": [{"refs": [{"id": "ref-for-mirrors-metapath"}, {"id": "ref-for-mirrors-metapath\u2460"}], "title": "4.7. File formats: mirrors.json"}], "external": false};
window.dfnpanelData['targetspath'] = {"dfnID": "targetspath", "url": "#targetspath", "dfnText": "TARGETSPATH", "refSections": [{"refs": [{"id": "ref-for-targetspath"}, {"id": "ref-for-targetspath\u2460"}], "title": "4.7. File formats: mirrors.json"}], "external": false};</script>
<script>/* script-dom-helper */
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>